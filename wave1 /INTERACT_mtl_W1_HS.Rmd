---
title: "INTERACT Montreal Results Health Survey Wave 1"
date: "30 septembre, 2019"
output: 
  html_document:
    df_print: paged
    code_folding: hide
    fig_height: 7
    fig_width: 12
    toc: true
    toc_float: true

---

```{r setup,message=FALSE,warning=FALSE, include=FALSE, results='asis'}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)

# Pre Process Your Data
# Add applicable packages to the R Markdown
library(knitr)
library(kableExtra)
library(plyr)
library(survey)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(kableExtra)
library(forcats)
library(sjmisc)
library(lubridate)
library(eeptools)
library(likert)
library(data.table)
library(stringr)
library(tidyverse)

# Set Working Directory 
# This is the folder path where all your working data will be stored (note: the backslashes are important here. Make sure it's / and not \)
setwd("I:/Chercheurs/Kestens_Yan/Spherelab/Prj2017_INTERACT/DATA/_Treksoft_2019_10_10_2851c89")

# Import Dataset(s)

Health <- read.csv("health_1mtl_main_2851c89.csv")

d <- Health

cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7") #COLOURBLIND PALETTE 
INTERACTPalette <- c("#1596FF", "#76D24A", "#404041", "#666666", "#EBF0F8") #ALLBRANDING 
INTERACTPalettecont <- c("#76D24A", "#6BCB5E", "#60C472", "#55BE86", "#4AB79A", "#40B0AE", "#35AAC2", "#2AA3D6", "#1F9CEA", "#1596FF") #10 
INTERACTPaletteSet <- c("#76D24A", "#1596FF", "#291EF8" ,"#FFD21F", "#EB2EBA","#EBF0F8", "#FF6A6A", "#AC26F2", "#1596FF", "#E5364D") #10
INTERACTPalette3 <- c("#76D24A", "#60C472", "#4AB79A",  "#35AAC2", "#1F9CEA", "#1596FF") #6
INTERACTPaletteYN <- c("#1596FF", "#404041", "#EBF0F8") #3
INTERACTfade <- c("#1596FF", "#2ca0ff", "#43abff", "#5bb5ff", "#72c0ff", "#8acaff", "#a1d5ff", "#b8dfff", "#d0eaff", "#e7f4ff", "#f3f9ff", "#ffffff") #12
INTERACTshortfade <- c("#1596FF", "#43abff", "#72c0ff",  "#a1d5ff",  "#d0eaff", "#ffffff") #6 
INTERACTshorterfade <- c("#1596FF", "#72c0ff","#d0eaff", "#ffffff") #4



# confirm cleaning used here

eth <- d[239:254]


eth[eth$group_id_mtl_txt %in% c("Eastern European descent", "Eurasienne", "European", "European Caucasian", "Français", "Français" , "France" , "Greek" , "Greek, Italian" , "Hungarian", "Polish" , "Québécois", "Québécois", "Roumain", "Arménien", "Belge", "caucasien"), "group_id_mtl_13"] <- 0

eth[eth$group_id_mtl_txt %in% c("Eastern European descent", "Eurasienne", "European", "European Caucasian", "Français", "Français" , "France" , "Greek" , "Greek, Italian" , "Hungarian", "Polish" , "Québécois", "Québécois", "Roumain", "Arménien", "Belge", "caucasien"), "group_id_mtl_2"] <- 1 


eth[eth$group_id_mtl_txt %in% c("berbère (Kabyle)", "Maghrébine", "Middle Eastern"), "group_id_mtl_13"] <- 0

    
eth[eth$group_id_mtl_txt %in% c("berbère (Kabyle)", "Maghrébine", "Middle Eastern"), "group_id_mtl_8"] <- 1
      

eth[eth$group_id_mtl_txt %in% c("European (West; Celtic; Nordic); African; Indo-Asian; Rom","Araboquebecoise (metis)" ,"jewish","Jewish","Scottish and West Indian" ,"créole","Métis antillais", "A mix of Polish and Jewish ... ", "Je choisis Autre pour faire un commentaire. Blanc ou Noir ne sont pas des groupes ethniques ou culturels."), "group_id_mtl_13"] <- 0


eth[17] <- NULL

eth$mixte <- NA
eth$mixte <- ifelse((eth[3] + eth[4] + eth[5]+ eth[6]+ eth[7]+ eth[8]+ eth[9]+ eth[10]+ eth[11] + eth[12] + eth[13] + eth[14] + eth[15] + eth[16]) == 1, 0, 1)

for(i in 3:16){
  eth[i][eth$mixte == 1] <- 0
}

eth$eth <- NA
eth$eth[eth$group_id_mtl_1 == 1] <- "Aboriginal"
eth$eth[eth$group_id_mtl_2 == 1] <- "White"
eth$eth[eth$group_id_mtl_3 == 1] <- "South Asian"
eth$eth[eth$group_id_mtl_4 == 1] <- "Chinese"
eth$eth[eth$group_id_mtl_5 == 1] <- "Black"
eth$eth[eth$group_id_mtl_6 == 1] <- "Filipino"
eth$eth[eth$group_id_mtl_7 == 1] <- "Latin American"
eth$eth[eth$group_id_mtl_8 == 1] <- "Arab"
eth$eth[eth$group_id_mtl_9 == 1] <- "Southeast Asian"
eth$eth[eth$group_id_mtl_10 == 1] <- "West Asian"
eth$eth[eth$group_id_mtl_11 == 1] <- "Korean"
eth$eth[eth$group_id_mtl_12 == 1] <- "Japanese"
eth$eth[eth$group_id_mtl_77 == 1] <- "I don't know/Prefer not to answer"
eth$eth[eth$mixte == 1] <- "Other/mixed identity"

eth[eth$group_id_mtl_txt %in% c("European (West; Celtic; Nordic); African; Indo-Asian; Rom","Araboquebecoise (metis)" ,"jewish","Jewish","Scottish and West Indian" ,"créole","Métis antillais", "A mix of Polish and Jewish ... ", "Je choisis Autre pour faire un commentaire. Blanc ou Noir ne sont pas des groupes ethniques ou culturels."), "group_id_mtl_mixte"] <- 1


```





The INTErventions, Research, and Action in Cities Team (INTERACT) is a national research collaboration of scientists, urban planners, and engaged citizens uncovering how the design of our cities is shaping the health and wellbeing of Canadians (www.teaminteract.ca). INTERACT is conducting longitudinal, mixed-methods natural experiment studies in four Canadian cities, with the aim of providing evidence on the impacts of urban transformations on people's physical activity, social participation, and wellbeing, and inequalities in these outcomes. 

As part of Plan Montreal durable 2016-2020, the City of Montreal, its boroughs, neighbouring cities and partnering organizations are implementing urban interventions, such as traffic calming measures, changes in transportation infrastructure, placemaking, and greening programs. Sampled from the Island of Montreal, and the following off-island cities: Longueuil, Brossard, Saint-Lambert, and Laval, participants were recruited from June 6th to December 21th, 2018 (199 days). Participants were entered into a prize draw to incentivize their participation. Exclusion criteria across all sites were being younger than 18 years old, not being able to read or write English (or English or French in Montreal) well enough to answer an online survey and any intention to move out of the region in the next two years.
Participants were recruited through a letter campaign, social media, media articles, partner networks, snowball sampling, and in-person events. 

Across Montreal, Laval, Longueuil, Brossard and Saint-Lambert, 1155 participants completed the Health Questionnaire.







## Section 1: Transportation 

### What modes of transportation do you use? Please check all that apply.

```{r}

# Create a vector with variable names
response = paste0("mode_used_", 1:8)

# Empty vector to stor output
mode_use_prop <- c()

# Calculate univariate proportions
for(i in response){
  mode_use_prop[i] <- sum(d[,i]) / nrow(d)
}

# Transform
mode_use_prop <- as.data.frame(mode_use_prop)
mode_use_prop$mode <- c("Walking","Biking","Public transit","Car","Motorcycle or scooter","Taxi or Uber","Car-sharing service","Other")

mode_use_prop$plot<- factor(mode_use_prop$mode, mode_use_prop$mode)

ggplot(mode_use_prop, aes(x = plot, y = mode_use_prop)) + geom_bar(stat = "identity", fill = "#76D24A") +xlab("") + ylab("Percent of participants who use this mode") + theme(axis.text.x  = element_text(size=12, angle=0, vjust=.6)) + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10))


mode_use_prop <- mode_use_prop[-c(3)]
mode_use_prop$mode_use_prop <- round(mode_use_prop$mode_use_prop*100,2)

mode_use_prop <- setcolorder(mode_use_prop, c("mode", "mode_use_prop"))

colnames(mode_use_prop) <- c("Response", "Percent of participants who use this mode")

kable(mode_use_prop) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  
 

```

### Even if you do not personally use this mode of transportation, do you find {.tabset}

#### cycling in your city to be.

  
```{r}
#perception_cycling_a

# Subset 
perception_cycling <- d[,c("perception_cycling_a", "perception_cycling_b", "perception_cycling_c", "perception_cycling_d","perception_cycling_e")]


# Rename columns
colnames(perception_cycling) <- c( "a. Safe?", "b. Reliable?", 
                            "c. Practical?", "d. Enjoyable?", "e. Affordable?")


#revalue(as.factor(perception_cycling), c("1" = "Very", "4" = "Not at all", "I don't know")) 


# Change columns to factor
perception_cycling[] <- lapply(perception_cycling, factor)

##Create question names for plot display
items <- likert(perception_cycling)

#realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "#1596FF",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100)

perception_cycling_tb <- summary(perception_cycling)
row.names(perception_cycling_tb)= c("1"= "1- Very", "2", "3", "4" = "4- Not at all", "77" = "Don't know")

kable(perception_cycling_tb) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 

```


#### driving in your city to be.

```{r}

# Subset 
perception_driving <- d[,c("perception_driving_a", "perception_driving_b", "perception_driving_c", "perception_driving_d","perception_driving_e")]


# Rename columns
colnames(perception_driving) <- c( "a. Safe?", "b. Reliable?", 
                            "c. Practical?", "d. Enjoyable?", "e. Affordable?")

# Change columns to factor
perception_driving[] <- lapply(perception_driving, factor)

##Create question names for plot display
items <- likert(perception_driving)

##realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "#1596FF",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)
perception_driving_tb <- summary(perception_driving)
row.names(perception_driving_tb)= c("1"= "1- Very", "2", "3", "4" = "4- Not at all", "77" = "Don't know")

kable(perception_driving_tb) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 

```

#### walking in your city to be.


```{r}

# zoe:temporary work around because no 77 for perception_walking_C - need help dealing with uneven levels

d$perception_walking_a[d$perception_walking_a==77] <- NA
d$perception_walking_b[d$perception_walking_b==77] <- NA
d$perception_walking_c[d$perception_walking_c==77] <- NA
d$perception_walking_d[d$perception_walking_d==77] <- NA
d$perception_walking_e[d$perception_walking_e==77] <- NA


# #Subset
perception_walking <- d[,c("perception_walking_a", "perception_walking_b", "perception_walking_c", "perception_walking_d","perception_walking_e")]

# Rename columns
colnames(perception_walking) <- c( "a. Safe?", "b. Reliable?","c. Practical?", "d. Enjoyable?", "e. Affordable?")
# 
# # Change columns to factor
perception_walking[] <- lapply(perception_walking, factor)


##Create question names for plot display
items <- likert(perception_walking)

#realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "#1596FF",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)

perception_walking_tb <- summary(perception_walking)
row.names(perception_walking_tb)= c("1"= "1- Very", "2", "3", "4" = "4- Not at all", "77" = "Don't know")

kable(perception_walking_tb) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```


#### transit in your city to be.

```{r}

# Subset 
perception_transit <- d[,c("perception_transit_a", "perception_transit_b", "perception_transit_c", "perception_transit_d","perception_transit_e")]


# Rename columns
colnames(perception_transit) <- c( "a. Safe?", "b. Reliable?", 
                            "c. Practical?", "d. Enjoyable?", "e. Affordable?")

# Change columns to factor
perception_transit[] <- lapply(perception_transit, factor)

##Create question names for plot display
items <- likert(perception_transit)

##realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "#1596FF",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)

perception_transit_tb <- summary(perception_transit)
row.names(perception_transit_tb)= c("1"= "1- Very", "2", "3", "4" = "4- Not at all", "77" = "Don't know")

kable(perception_transit_tb) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 

```


### How often do you typically travel during each season by {.tabset}

#### bicycle 
```{r}


d$bike_freq_a[d$bike_freq_a==-7] <- NA
ggplot(d, aes(x = d$bike_freq_a)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#FFA314") + xlab("Times in the fall")

d$bike_freq_b[d$bike_freq_b==-7] <- NA
ggplot(d, aes(x = d$bike_freq_b)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#1596FF") + xlab("Times in the winter")

d$bike_freq_c[d$bike_freq_c==-7] <- NA
ggplot(d, aes(x = d$bike_freq_c)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#76D24A") + xlab("Times in the spring")

d$bike_freq_d[d$bike_freq_d==-7] <- NA
ggplot(d, aes(x = d$bike_freq_d)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#F2B705") + xlab("Times in the summer")


```

#### car

```{r}

d$car_freq_a[d$car_freq_a==-7] <- NA
ggplot(d, aes(x = d$car_freq_a)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#BF5B04") + xlab("Times in the fall")

d$car_freq_b[d$car_freq_b==-7] <- NA
ggplot(d, aes(x = d$car_freq_b)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#35AAF2") + xlab("Times in the winter")

d$car_freq_c[d$car_freq_c==-7] <- NA
ggplot(d, aes(x = d$car_freq_c)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#7C8C03") + xlab("Times in the spring")

d$car_freq_d[d$car_freq_d==-7] <- NA
ggplot(d, aes(x = d$car_freq_d)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#F2B705") + xlab("Times in the summer")

```

#### foot

```{r}

d$walk_freq_a[d$walk_freq_a==-7] <- NA
ggplot(d, aes(x = d$walk_freq_a)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#BF5B04") + xlab("Times in the fall")

d$walk_freq_b[d$walk_freq_b==-7] <- NA
ggplot(d, aes(x = d$walk_freq_b)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#35AAF2") + xlab("Times in the winter")

d$walk_freq_c[d$walk_freq_c==-7] <- NA
ggplot(d, aes(x = d$walk_freq_c)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#7C8C03") + xlab("Times in the spring")

d$walk_freq_d[d$walk_freq_d==-7] <- NA
ggplot(d, aes(x = d$walk_freq_d)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#F2B705") + xlab("Times in the summer")

```

#### transit 

```{r}

d$transit_freq_a[d$transit_freq_a==-7] <- NA
ggplot(d, aes(x = d$transit_freq_a)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#BF5B04") + xlab("Times in the fall")

d$transit_freq_b[d$transit_freq_b==-7] <- NA
ggplot(d, aes(x = d$transit_freq_b)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#35AAF2") + xlab("Times in the winter")

d$transit_freq_c[d$transit_freq_c==-7] <- NA
ggplot(d, aes(x = d$transit_freq_c)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#7C8C03") + xlab("Times in the spring")

d$transit_freq_d[d$transit_freq_d==-7] <- NA
ggplot(d, aes(x = d$transit_freq_d)) + geom_histogram (na.rm = TRUE, binwidth = 5, fill="#F2B705") + xlab("Times in the summer")

```

### How many cars, trucks, or vans are kept in your household?

```{r}

#cars_household

ggplot(d, aes(x = d$cars_household)) + geom_histogram(na.rm = TRUE, fill="#76d24a") + xlab("Number of cars, trucks or vans in household")

summary(d$cars_household)

```


### Do you have access to a car kept outside of your household?

_note: Participants could select multiple answers. This table shows the percentage of participants who selected each answer._

```{r}

#cars_access_outside

# Create a vector with variable names
response = paste0("cars_access_outside_", 1:4)

# Empty vector to stor output
car_access_outside_prop <- c()

# Calculate univariate proportions
for(i in response){
  car_access_outside_prop[i] <- sum(d[,i]) / nrow(d)
}

# Transform
car_access_outside_prop <- as.data.frame(car_access_outside_prop)
car_access_outside_prop$Response <- c("Yes, I borrow a friend's or relative's car","Yes, I am a member of a car-sharing program (Communauto, Car2go, etc.) ","Yes, for another reason (Please specify)","No, I do not have access to a car kept outside of my household")

car_access_outside_prop$plot<- factor(car_access_outside_prop$Response, car_access_outside_prop$Response)

ggplot(car_access_outside_prop, aes(x = plot, y = car_access_outside_prop)) + geom_bar(stat = "identity", fill = "#76D24A") + xlab("") + ylab("Percentage of participants who selected this answer") + theme(axis.text.x  = element_text(size=12, angle=0, vjust=.6)) + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10))

car_access_outside_prop$car_access_outside_prop <- round(car_access_outside_prop$car_access_outside_prop*100,2)

car_access_outside_prop <- setcolorder(car_access_outside_prop, c("Response", "car_access_outside_prop"))

colnames(car_access_outside_prop) <- c("Response", "Percentage of participants who selected this answer")

car_access_outside_prop <- car_access_outside_prop[-c(3)]
kable(car_access_outside_prop) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  

```


### Do you currently have a valid driver's license?


```{r}

#license

# Create proportional table
license <- round(prop.table(table(d$license))*100,2)
license <- as.data.frame(license)
license$group <- substring(rownames(license), 1)
# or use colnames(license)[1] <- "group" : 

# Change category values and transform in factor
## as.character(license$group) is because as.data.frame transform character into factor
license$group <- revalue(as.character(license$group), c("1" = "Yes", "2" = "No"))

# Create plot
license$plot <- factor(license$group, license$group) ## Necessary to order x-axis in ggplot

license.plot <- ggplot(license, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("")
      
license.plot + geom_histogram(aes(x = plot), data = license, stat = "identity")

# make a clean summary table 
## make a dataframe on count 
license.tb <- as.factor(d$license)
license.tb <- summary(license.tb)
license.tb <- as.data.frame(license.tb)
license.tb$Var1 <- substring(row.names(license.tb), 1)
license.tb$group <- revalue(as.character(license.tb$Var1), c("1" = "Yes", "2" = "No"))


## merge with existing prop table data used for plot above 
## order doesn't work
plot.license.tb <- merge(license, license.tb, by = "group")
plot.license.tb <- plot.license.tb[-c(2, 4, 6)]
plot.license.tb <- setcolorder(plot.license.tb, c("group", "license.tb", "Freq"))

colnames(plot.license.tb) <- c("Response", "N", "Percentage")

kable(plot.license.tb) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  


```

### Do you have access to a bicycle? Check all that apply.

_note: Participants could select multiple answers. This table shows how frequently each answer was selected._


```{r}

#bike_access_options

# Create a vector with variable names
response_bike = paste0("bike_access_options_", 1:5)

# Empty vector to stor output
bike_access_options_prop <- c()

# Calculate univariate proportions
for(i in response_bike){
  bike_access_options_prop[i] <- sum(d[,i]) / nrow(d)
}

# Transform
bike_access_options_prop <- as.data.frame(bike_access_options_prop)
bike_access_options_prop$Response <- c("No, I do not have access to a bicycle","Yes, I own a bicycle","Yes, I borrow a friend's or relative's bicycle","Yes, I use a bike share service (BIXI, Dropbike, etc.)", "Yes, I have access to a bicycle through another way (please specify)")


bike_access_options_prop$plot<- factor(bike_access_options_prop$Response, bike_access_options_prop$Response)

ggplot(bike_access_options_prop, aes(x = plot, y = bike_access_options_prop)) + geom_bar(stat = "identity", fill = "#76D24A") + xlab("") + ylab("Percentage of participants who selected this answer") + theme(axis.text.x  = element_text(size=10, angle=0, vjust=.6)) + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10))

bike_access_options_prop$bike_access_options_prop <- round(bike_access_options_prop$bike_access_options_prop*100,2)

bike_access_options_prop <- setcolorder(bike_access_options_prop, c("Response", "bike_access_options_prop"))

colnames(bike_access_options_prop) <- c("Response", "Percentage of participants who selected this answer")

bike_access_options_prop <- bike_access_options_prop[-c(3)]
kable(bike_access_options_prop) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 
```


## Section 2: Physical Activity

### During the last 7 days, on how many days did you do vigorous physical activities like heavy lifting, digging, heavy construction, or climbing up stairs as part of your work? Think about only those physical activities that you did for at least 10 minutes at a time.

```{r work_vipa }

#work_vigpa

ggplot(d, aes(x = d$work_vigpa)) + geom_histogram(na.rm = TRUE, fill = "#1596FF") + xlab("N days vigorous job-related physical activity")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$work_vigpa)), Percentage = round(as.numeric(prop.table(table(d$work_vigpa)))*100,2))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

### How much time did you usually spend on one of those days doing vigorous physical activities as part of your work?

```{r work_vigpa_freq}

#work_vigpa_freq

d$work_vigpa_freq[d$work_vigpa_freq==-7] <- NA

ggplot(d, aes(x = d$work_vigpa_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes vigorous job-related physical activity") 

summary(d$work_vigpa_freq)
```

### Again, think about only those physical activities that you did for at least 10 minutes at a time. During the last 7 days, on how many days did you do moderate physical activities like carrying light loads as part of your work? Please do not include walking.

```{r}
#work_modpa

ggplot(d, aes(x = d$work_modpa)) + geom_histogram(na.rm = TRUE, fill="#1596FF") + xlab("N days moderate job-related physical activity")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$work_modpa)), Percentage = round(as.numeric(prop.table(table(d$work_modpa)))*100,2))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

### How much time did you usually spend on one of those days doing moderate physical activities as part of your work?

```{r}

#work_modpa_freq

d$work_modpa_freq[d$work_modpa_freq==-7] <- NA
ggplot(d, aes(x = d$work_modpa_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes moderate job-related physical activity") 

summary(d$work_modpa_freq)

```

### During the last 7 days, on how many days did you travel in a motor vehicle like a train, bus, car, or metro?

```{r}
#travel_motor

ggplot(d, aes(x = d$travel_motor)) + geom_histogram(na.rm = TRUE, fill="#1596FF") + xlab("N days")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$travel_motor)), Percentage = round(as.numeric(prop.table(table(d$travel_motor)))*100,2))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### How much time did you usually spend on one of those days travelling in a train, bus, car, metro, or other kind of motor vehicle?
```{r}
#travel_motor_freq

d$travel_motor_freq[d$travel_motor_freq==-7] <- NA
ggplot(d, aes(x = d$travel_motor_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes travel time") 

summary(d$travel_motor_freq)
```

### During the last 7 days, on how many days did you bicycle for at least 10 minutes at a time to go from place to place?

```{r}
#travel_bike

ggplot(d, aes(x = d$travel_bike)) + geom_histogram(na.rm = TRUE, fill="#1596FF") + xlab("N days")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$travel_bike)), Percentage = round(as.numeric(prop.table(table(d$travel_bike)))*100,2))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```
### How much time did you usually spend on one of those days to bicycle from place to place?

```{r}
#travel_bike_freq

d$travel_bike_freq[d$travel_bike_freq==-7] <- NA
ggplot(d, aes(x = d$travel_bike_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes travel time") 

summary(d$travel_bike_freq)
```

### During the last 7 days, on how many days did you walk for at least 10 minutes at a time to go from place to place?

```{r}
#travel_walk

ggplot(d, aes(x = d$travel_walk)) + geom_histogram(na.rm = TRUE, fill="#1596FF") + xlab("# of days in the last 7 days")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$travel_walk)), Percentage = round(as.numeric(prop.table(table(d$travel_walk)))*100,2))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

### How much time did you usually spend on one of those days walking from place to place?

```{r}
#travel_walk_freq

d$travel_walk_freq[d$travel_walk_freq==-7] <- NA

ggplot(d, aes(x = d$travel_walk_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes travel time") 

summary(d$travel_walk_freq)
```

### Not counting any walking for transportation that you have already mentioned, during the last 7 days, on how many days did you walk for at least 10 minutes at a time in your leisure time?

```{r}
#leisure_walk

ggplot(d, aes(x = d$leisure_walk)) + geom_histogram(na.rm = TRUE, fill="#1596FF") + xlab("N days")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$leisure_walk)), Percentage = round(as.numeric(prop.table(table(d$leisure_walk))*100,2)))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### How much time did you usually spend on one of those days walking in your leisure time?
```{r}

#leisure_walk_freq

d$leisure_walk_freq[d$leisure_walk_freq==-7] <- NA

ggplot(d, aes(x = d$leisure_walk_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes leisure time") 

summary(d$leisure_walk_freq)

```

### Think about only those physical activities that you did for at least 10 minutes at a time, not counting any activity for transportation or work that you have already mentioned. During the last 7 days, on how many days did you do vigorous physical activities like aerobics, running, fast bicycling, or fast swimming in your leisure time?

```{r}
#leisure_vigpa

ggplot(d, aes(x = d$leisure_vigpa)) + geom_histogram(na.rm = TRUE, fill="#1596FF") + xlab("N days")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$leisure_vigpa)), Percentage = round(as.numeric(prop.table(table(d$leisure_vigpa))*100,2)))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

### How much time did you usually spend on one of those days doing vigorous physical activities in your leisure time?

```{r}

#leisure_vigpa_freq

d$leisure_vigpa_freq[d$leisure_vigpa_freq==-7] <- NA

ggplot(d, aes(x = d$leisure_vigpa_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes leisure time") 

summary(d$leisure_vigpa_freq)

```

### During the last 7 days, on how many days did you do moderate physical activities like bicycling at a regular pace, swimming at a regular pace, or doubles tennis in your leisure time?

```{r}

#leisure_modpa

ggplot(d, aes(x = d$leisure_modpa)) + geom_histogram(na.rm = TRUE, fill="#1596FF") + xlab("N days")

kable(data.frame(Days = 0:7, N = as.numeric(table(d$leisure_modpa)), Percentage = round(as.numeric(prop.table(table(d$leisure_modpa))*100,2)))) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

### How much time did you usually spend on one of those days doing moderate physical activities in your leisure time?


```{r}
#leisure_modpa_freq

d$leisure_modpa_freq[d$leisure_modpa_freq==-7] <- NA

ggplot(d, aes(x = d$leisure_modpa_freq)) + geom_histogram(na.rm = TRUE, binwidth = 20, fill= "#35AAC2") + xlab("Minutes leisure time") 

summary(d$leisure_modpa_freq)
```

### During the last 7 days, how much time did you usually spend sitting on a weekday?

```{r}

#sit_weekday

ggplot(d, aes(x = d$sit_weekday/60)) + geom_histogram(na.rm = TRUE, binwidth = 1, fill= "#35AAC2") + xlab("Hours sitting, weekday") 

summary(d$sit_weekday)

```

### During the last 7 days, how much time did you usually spend sitting on a weekend day?

```{r}
#sit_weekend

ggplot(d, aes(x = d$sit_weekend/60)) + geom_histogram(na.rm = TRUE, binwidth = 1, fill= "#35AAC2") + xlab("Hours sitting, weekend") 

summary(d$sit_weekend)


```

## Section 3: General Health 

### How tall are you?

```{r}
#height

d$height[d$height==24] <- NA
d$height[d$height==28] <- NA
d$height[d$height==37] <- NA
d$height[d$height==65] <- NA

ggplot(d, aes(x = d$height)) + geom_histogram(na.rm = TRUE, binwidth = 2, fill="#76D24A") + xlab("Height (cm)") 

summary(d$height)
```

### How much do you weigh?

```{r}

#weight


d$weight[d$weight==0] <- NA
d$weight[d$weight==18] <- NA


ggplot(d, aes(x = d$weight)) + geom_histogram(na.rm = TRUE, binwidth = 2, fill="#76D24A") + xlab("Weight (kg)") 

summary(d$weight)

```


### In general, would you say your health is:

```{r}
#sf1

# Create proportional table
sf1 <- round(prop.table(table(d$sf1))*100,2)
sf1 <- as.data.frame(sf1)
sf1$group <- substring(rownames(sf1), 1)
# or use colnames(sf1)[1] <- "group" : 

# Change category values and transform in factor
## as.character(sf1$group) is because as.data.frame transform character into factor
sf1$group <- revalue(as.character(sf1$group), c("1" = "Excellent", "2" = "Very good", "3" = "Good", "4" = "Fair", "5" = "Poor"))

# Create plot
sf1$plot <- factor(sf1$group, sf1$group) ## Necessary to order x-axis in ggplot

sf1.plot <- ggplot(sf1, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalettecont) +
      ylab("Percent of total") +
      xlab("")
      
sf1.plot + geom_histogram(aes(x = plot), data = sf1, stat = "identity")

# make a clean summary table 
## make a dataframe on count 
sf1.tb <- as.factor(d$sf1)
sf1.tb <- summary(sf1.tb)
sf1.tb <- as.data.frame(sf1.tb)
sf1.tb$Var1 <- substring(row.names(sf1.tb), 1)
sf1.tb$group <- revalue(as.character(sf1.tb$Var1), c("1" = "Excellent", "2" = "Very good", "3" = "Good", "4" = "Fair", "5" = "Poor"))


## merge with existing prop table data used for plot above 
## order doesn't work
plot.sf1.tb <- merge(sf1, sf1.tb, by = "group")
plot.sf1.tb <- plot.sf1.tb[-c(2, 4, 6)]
plot.sf1.tb <- setcolorder(plot.sf1.tb, c("group", "sf1.tb", "Freq"))

plot.sf1.tb$order <- c(1, 4, 3, 5, 2)
plot.sf1.tb <- plot.sf1.tb %>% arrange(order)
plot.sf1.tb <- plot.sf1.tb[-c(4)]
colnames(plot.sf1.tb) <- c("Response", "N", "Percentage")

kable(plot.sf1.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 

```


### The following questions are about activities you might do during a typical day. Does your health now limit you in these activities? If so, how much? {.tabset}

#### a. Moderate activities such as moving a table, pushing a vacuum cleaner, bowling, or playing golf

```{r sf2}

sf2 <- round(prop.table(table(factor(d$sf2, levels = c("1", "2", "3")), exclude = NULL))*100,2)
sf2 <- as.data.frame(sf2)
sf2$group <- substring(row.names(sf2), 1)
sf2$group <- revalue(as.character(sf2$group), c("1" = "Yes, limited a lot",  "2" = "Yes, limited a little", "3" = "No, not at all"))

sf2$plot <- factor(sf2$group, sf2$group)

sf2.plot <- ggplot(sf2, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
sf2.plot + geom_histogram(aes(x = plot), data = sf2, stat = "identity")


sf2.tb <- as.factor(d$sf2)
sf2.tb <- summary(sf2.tb)
sf2.tb <- as.data.frame(sf2.tb)
sf2.tb$Var1 <- substring(row.names(sf2.tb), 1)
sf2.tb$group <- revalue(as.character(sf2.tb$Var1), c("1" = "Yes, limited a lot",  "2" = "Yes, limited a little", "3" = "No, not at all"))
plot.sf2.tb <- merge(sf2, sf2.tb, by = "group")
plot.sf2.tb <- plot.sf2.tb[-c(2, 4, 6)]
plot.sf2.tb <- setcolorder(plot.sf2.tb, c("group", "sf2.tb", "Freq"))
plot.sf2.tb$order <- c(3, 2, 1)
plot.sf2.tb <- plot.sf2.tb %>% arrange(order)
plot.sf2.tb <- plot.sf2.tb[-c(4)]
colnames(plot.sf2.tb) <- c("Response", "N", "Percentage")

kable(plot.sf2.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

#### b. Climbing several flights of stairs

```{r sf3}

# sf3 

sf3 <- round(prop.table(table(factor(d$sf3, levels = c("1", "2", "3")), exclude = NULL))*100,2)
sf3 <- as.data.frame(sf3)
sf3$group <- substring(row.names(sf3), 1)
sf3$group <- revalue(as.character(sf3$group), c("1" = "Yes, limited a lot",  "2" = "Yes, limited a little", "3" = "No, not at all"))

sf3$plot <- factor(sf3$group, sf3$group)

sf3.plot <- ggplot(sf3, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
      
sf3.plot + geom_histogram(aes(x = plot), data = sf3, stat = "identity") 

# summary table

sf3.tb <- as.factor(d$sf3)
sf3.tb <- summary(sf3.tb)
sf3.tb <- as.data.frame(sf3.tb)
sf3.tb$Var1 <- substring(row.names(sf3.tb), 1)
sf3.tb$group <- revalue(as.character(sf3.tb$Var1), c("1" = "Yes, limited a lot",  "2" = "Yes, limited a little", "3" = "No, not at all"))
plot.sf3.tb <- merge(sf3, sf3.tb, by = "group")
plot.sf3.tb <- plot.sf3.tb[-c(2, 4, 6)]
plot.sf3.tb <- setcolorder(plot.sf3.tb, c("group", "sf3.tb", "Freq"))
plot.sf3.tb$order <- c(3, 2, 1)
plot.sf3.tb <- plot.sf3.tb %>% arrange(order)
plot.sf3.tb <- plot.sf3.tb[-c(4)]
colnames(plot.sf3.tb) <- c("Response", "N", "Percentage")

kable(plot.sf3.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### During the past 4 weeks, have you had any of the following problems with your work or other regular daily activities as a result of your physical health? {.tabset}

#### a. Accomplished less than you would like

```{r}
#sf4 

sf4<- round(prop.table(table(factor(d$sf4, levels = c("1", "2")), exclude = NULL))*100,2)
sf4 <- as.data.frame(sf4)
sf4$group <- substring(row.names(sf4), 1)
sf4$group <- revalue(as.character(sf4$group), c("1" = "Yes",  "2" = "No"))

sf4$plot <- factor(sf4$group, sf4$group)

sf4.plot <- ggplot(sf4, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

sf4.plot + geom_histogram(aes(x = plot), data = sf4, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")


sf4.tb <- as.factor(d$sf4)
sf4.tb <- summary(sf4.tb)
sf4.tb <- as.data.frame(sf4.tb)
sf4.tb$Var1 <- substring(row.names(sf4.tb), 1)
sf4.tb$group <- revalue(as.character(sf4.tb$Var1), c("1" = "Yes", "2" = "No"))
plot.sf4.tb <- merge(sf4, sf4.tb, by = "group")
plot.sf4.tb <- plot.sf4.tb[-c(2, 4, 6)]
plot.sf4.tb <- setcolorder(plot.sf4.tb, c("group", "sf4.tb", "Freq"))
plot.sf4.tb$order <- c(2, 1)
plot.sf4.tb <- plot.sf4.tb %>% arrange(order)
plot.sf4.tb <- plot.sf4.tb[-c(4)]
colnames(plot.sf4.tb) <- c("Response", "N", "Percentage")

kable(plot.sf4.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### b. Were limited in the kind of work or other activities

```{r}

#sf5
sf5<- round(prop.table(table(factor(d$sf5, levels = c("1", "2")), exclude = NULL))*100,2)
sf5 <- as.data.frame(sf5)
sf5$group <- substring(row.names(sf5), 1)
sf5$group <- revalue(as.character(sf5$group), c("1" = "Yes",  "2" = "No"))

sf5$plot <- factor(sf5$group, sf5$group)

sf5.plot <- ggplot(sf5, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

sf5.plot + geom_histogram(aes(x = plot), data = sf5, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

sf5.tb <- as.factor(d$sf5)
sf5.tb <- summary(sf5.tb)
sf5.tb <- as.data.frame(sf5.tb)
sf5.tb$Var1 <- substring(row.names(sf5.tb), 1)
sf5.tb$group <- revalue(as.character(sf5.tb$Var1), c("1" = "Yes", "2" = "No"))
plot.sf5.tb <- merge(sf5, sf5.tb, by = "group")
plot.sf5.tb <- plot.sf5.tb[-c(2, 4, 6)]
plot.sf5.tb <- setcolorder(plot.sf5.tb, c("group", "sf5.tb", "Freq"))
plot.sf5.tb$order <- c(2, 1)
plot.sf5.tb <- plot.sf5.tb %>% arrange(order)
plot.sf5.tb <- plot.sf5.tb[-c(4)]
colnames(plot.sf5.tb) <- c("Response", "N", "Percentage")

kable(plot.sf5.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

### During the past 4 weeks, have you had any of the following problems with your work or other regular daily activities as a result of any emotional problems (such as feeling depressed or anxious)? {.tabset}

#### a. Accomplished less than you would like

```{r}

#sf6

sf6<- round(prop.table(table(factor(d$sf6, levels = c("1", "2")), exclude = NULL))*100,2)
sf6 <- as.data.frame(sf6)
sf6$group <- substring(row.names(sf6), 1)
sf6$group <- revalue(as.character(sf6$group), c("1" = "Yes",  "2" = "No"))

sf6$plot <- factor(sf6$group, sf6$group)

sf6.plot <- ggplot(sf6, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

sf6.plot + geom_histogram(aes(x = plot), data = sf6, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

# summary table

sf6.tb <- as.factor(d$sf6)
sf6.tb <- summary(sf6.tb)
sf6.tb <- as.data.frame(sf6.tb)
sf6.tb$Var1 <- substring(row.names(sf6.tb), 1)
sf6.tb$group <- revalue(as.character(sf6.tb$Var1), c("1" = "Yes", "2" = "No"))
plot.sf6.tb <- merge(sf6, sf6.tb, by = "group")
plot.sf6.tb <- plot.sf6.tb[-c(2, 4, 6)]
plot.sf6.tb <- setcolorder(plot.sf6.tb, c("group", "sf6.tb", "Freq"))
plot.sf6.tb$order <- c(2, 1)
plot.sf6.tb <- plot.sf6.tb %>% arrange(order)
plot.sf6.tb <- plot.sf6.tb[-c(4)]
colnames(plot.sf6.tb) <- c("Response", "N", "Percentage")

kable(plot.sf6.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### b. Did work or activities less carefully than usual

```{r}

#sf7

sf7<- round(prop.table(table(factor(d$sf7, levels = c("1", "2")), exclude = NULL))*100,2)
sf7 <- as.data.frame(sf7)
sf7$group <- substring(row.names(sf7), 1)
sf7$group <- revalue(as.character(sf7$group), c("1" = "Yes",  "2" = "No"))

sf7$plot <- factor(sf7$group, sf7$group)

sf7.plot <- ggplot(sf7, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

sf7.plot + geom_histogram(aes(x = plot), data = sf7, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

sf7.tb <- as.factor(d$sf7)
sf7.tb <- summary(sf7.tb)
sf7.tb <- as.data.frame(sf7.tb)
sf7.tb$Var1 <- substring(row.names(sf7.tb), 1)
sf7.tb$group <- revalue(as.character(sf7.tb$Var1), c("1" = "Yes", "2" = "No"))
plot.sf7.tb <- merge(sf7, sf7.tb, by = "group")
plot.sf7.tb <- plot.sf7.tb[-c(2, 4, 6)]
plot.sf7.tb <- setcolorder(plot.sf7.tb, c("group", "sf7.tb", "Freq"))
plot.sf7.tb$order <- c(2, 1)
plot.sf7.tb <- plot.sf7.tb %>% arrange(order)
plot.sf7.tb <- plot.sf7.tb[-c(4)]
colnames(plot.sf7.tb) <- c("Response", "N", "Percentage")

kable(plot.sf7.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

### During the past 4 weeks, how much did pain interfere with your normal work (including work outside the home and housework)?

```{r}

#sf8

sf8 <- round(prop.table(table(factor(d$sf8, levels = c("1", "2", "3", "4", "5")), exclude = NULL))*100,2)
sf8 <- as.data.frame(sf8)
sf8$group <- substring(row.names(sf8), 1)
sf8$group <- revalue(as.character(sf8$group), c("1" = "Not at all",  "2" = "Slightly", "3" = "Moderately", "4" =  "Quite a bit", "5" = "Extremely"))

sf8$plot <- factor(sf8$group, sf8$group)

sf8.plot <- ggplot(sf8, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
      
sf8.plot + geom_histogram(aes(x = plot), data = sf8, stat = "identity") 


sf8.tb <- as.factor(d$sf8)
sf8.tb <- summary(sf8.tb)
sf8.tb <- as.data.frame(sf8.tb)
sf8.tb$Var1 <- substring(row.names(sf8.tb), 1)
sf8.tb$group <- revalue(as.character(sf8.tb$Var1), c("1" = "Not at all",  "2" = "Slightly", "3" = "Moderately", "4" =  "Quite a bit", "5" = "Extremely"))
plot.sf8 <- merge(sf8, sf8.tb, by = "group")
plot.sf8 <- plot.sf8[-c(2, 4, 6)]
plot.sf8 <- setcolorder(plot.sf8, c("group", "sf8.tb", "Freq"))
plot.sf8$order <- c(5,3,1,4,2)
plot.sf8 <- plot.sf8 %>% arrange(order)
plot.sf8 <- plot.sf8[-c(4)]
colnames(plot.sf8) <- c("Response", "N", "Percentage")

kable(plot.sf8) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### How much of the time during the past 4 weeks. {.tabset}

#### a. Have you felt calm and peaceful?
```{r}
#sf9 

sf9 <- round(prop.table(table(factor(d$sf9, levels = c("1", "2", "3", "4", "5", "6")), exclude = NULL))*100,2)
sf9 <- as.data.frame(sf9)
sf9$group <- substring(row.names(sf9), 1)
sf9$group <- revalue(as.character(sf9$group), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))

sf9$plot <- factor(sf9$group, sf9$group)

sf9.plot <- ggplot(sf9, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
      
sf9.plot + geom_histogram(aes(x = plot), data = sf9, stat = "identity") 

sf9.tb <- as.factor(d$sf9)
sf9.tb <- summary(sf9.tb)
sf9.tb <- as.data.frame(sf9.tb)
sf9.tb$Var1 <- substring(row.names(sf9.tb), 1)
sf9.tb$group <- revalue(as.character(sf9.tb$Var1), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))
plot.sf9 <- merge(sf9, sf9.tb, by = "group")
plot.sf9 <- plot.sf9[-c(2, 4, 6)]
plot.sf9 <- setcolorder(plot.sf9, c("group", "sf9.tb", "Freq"))
plot.sf9$order <- c(3,5,1,2,6,4)
plot.sf9 <- plot.sf9 %>% arrange(order)
plot.sf9 <- plot.sf9[-c(4)]
colnames(plot.sf9) <- c("Response", "N", "Percentage")

kable(plot.sf9) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### b. Did you have a lot of energy?

```{r}
sf10 <- round(prop.table(table(factor(d$sf10, levels = c("1", "2", "3", "4", "5", "6")), exclude = NULL))*100,2)
sf10 <- as.data.frame(sf10)
sf10$group <- substring(row.names(sf10), 1)
sf10$group <- revalue(as.character(sf10$group), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))

sf10$plot <- factor(sf10$group, sf10$group)

sf10.plot <- ggplot(sf10, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
      
sf10.plot + geom_histogram(aes(x = plot), data = sf10, stat = "identity") 

sf10.tb <- as.factor(d$sf10)
sf10.tb <- summary(sf10.tb)
sf10.tb <- as.data.frame(sf10.tb)
sf10.tb$Var1 <- substring(row.names(sf10.tb), 1)
sf10.tb$group <- revalue(as.character(sf10.tb$Var1), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))
plot.sf10 <- merge(sf10, sf10.tb, by = "group")
plot.sf10 <- plot.sf10[-c(2, 4, 6)]
plot.sf10 <- setcolorder(plot.sf10, c("group", "sf10.tb", "Freq"))
plot.sf10$order <- c(3,5,1,2,6,4)
plot.sf10 <- plot.sf10 %>% arrange(order)
plot.sf10 <- plot.sf10[-c(4)]
colnames(plot.sf10) <- c("Response", "N", "Percentage")

kable(plot.sf10) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```


#### c. Have you felt downhearted and blue?

```{r sf11}


#sf11

sf11 <- round(prop.table(table(factor(d$sf11, levels = c("1", "2", "3", "4", "5", "6")), exclude = NULL))*100,2)
sf11 <- as.data.frame(sf11)
sf11$group <- substring(row.names(sf11), 1)
sf11$group <- revalue(as.character(sf11$group), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))

sf11$plot <- factor(sf11$group, sf11$group)

sf11.plot <- ggplot(sf11, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
      
sf11.plot + geom_histogram(aes(x = plot), data = sf11, stat = "identity") 


sf11.tb <- as.factor(d$sf11)
sf11.tb <- summary(sf11.tb)
sf11.tb <- as.data.frame(sf11.tb)
sf11.tb$Var1 <- substring(row.names(sf11.tb), 1)
sf11.tb$group <- revalue(as.character(sf11.tb$Var1), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))
plot.sf11 <- merge(sf11, sf11.tb, by = "group")
plot.sf11 <- plot.sf11[-c(2, 4, 6)]
plot.sf11 <- setcolorder(plot.sf11, c("group", "sf11.tb", "Freq"))
plot.sf11$order <- c(3,5,1,2,6,4)
plot.sf11 <- plot.sf11 %>% arrange(order)
plot.sf11 <- plot.sf11[-c(4)]
colnames(plot.sf11) <- c("Response", "N", "Percentage")

kable(plot.sf11) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

### During the past 4 weeks, how much of the time has your physical health or emotional problems interfered with your social activities (like visiting friends, relatives, etc.)? 

```{r sf12}

#sf12

sf12 <- round(prop.table(table(factor(d$sf12, levels = c("1", "2", "3", "4", "5", "6")), exclude = NULL))*100,2)
sf12 <- as.data.frame(sf12)
sf12$group <- substring(row.names(sf12), 1)
sf12$group <- revalue(as.character(sf12$group), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))

sf12$plot <- factor(sf12$group, sf12$group)

sf12.plot <- ggplot(sf12, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
      
sf12.plot + geom_histogram(aes(x = plot), data = sf12, stat = "identity") 

sf12.tb <- as.factor(d$sf12)
sf12.tb <- summary(sf12.tb)
sf12.tb <- as.data.frame(sf12.tb)
sf12.tb$Var1 <- substring(row.names(sf12.tb), 1)
sf12.tb$group <- revalue(as.character(sf12.tb$Var1), c("1" = "All of the time",  "2" = "Most of the time", "3" = "A good bit of the time", "4" =  "Some of the time", "5" = "A little of the time", "6" = "None of the time"))
plot.sf12 <- merge(sf12, sf12.tb, by = "group")
plot.sf12 <- plot.sf12[-c(2, 4, 6)]
plot.sf12 <- setcolorder(plot.sf12, c("group", "sf12.tb", "Freq"))
plot.sf12$order <- c(3,5,1,2,6,4)
plot.sf12 <- plot.sf12 %>% arrange(order)
plot.sf12 <- plot.sf12[-c(4)]
colnames(plot.sf12) <- c("Response", "N", "Percentage")

kable(plot.sf12) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```


## Section 4: Well-being 

### Thinking about your own life and personal circumstances, how satisfied are you.{.tabset}

#### a. With your life as a whole?

```{r}
#pwb_a

pwb_a <- round(prop.table(table(factor(d$pwb_a)))*100,2)

pwb_a <- as.data.frame(pwb_a)
pwb_a$group <- substring(row.names(pwb_a), 1)
pwb_a$group <- revalue(as.character(pwb_a$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_a$plot <- factor(pwb_a$group, pwb_a$group)
pwb_a.plot <- ggplot(pwb_a, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_a.plot + geom_histogram(aes(x = plot), data = pwb_a, stat = "identity") 

pwb_a.tb <- as.factor(d$pwb_a)
pwb_a.tb <- summary(pwb_a.tb)
pwb_a.tb <- as.data.frame(pwb_a.tb)
pwb_a.tb$Var1 <- substring(row.names(pwb_a.tb), 1)
                           
pwb_a.tb$group <- revalue(as.character(pwb_a.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_a <- merge(pwb_a, pwb_a.tb, by = "group")
plot.pwb_a <- plot.pwb_a[-c(2, 4, 6)]
plot.pwb_a <- setcolorder(plot.pwb_a, c("group", "pwb_a.tb", "Freq"))
plot.pwb_a$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_a <- plot.pwb_a %>% arrange(order)
plot.pwb_a <- plot.pwb_a[-c(4)]
colnames(plot.pwb_a) <- c("Response", "N", "Percentage")

kable(plot.pwb_a) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

#### b. With your standard of living?

```{r}

#pwb_b

pwb_b <- round(prop.table(table(factor(d$pwb_b)))*100,2)

pwb_b <- as.data.frame(pwb_b)
pwb_b$group <- substring(row.names(pwb_b), 1)
pwb_b$group <- revalue(as.character(pwb_b$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_b$plot <- factor(pwb_b$group, pwb_b$group)
pwb_b.plot <- ggplot(pwb_b, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_b.plot + geom_histogram(aes(x = plot), data = pwb_b, stat = "identity") 

pwb_b.tb <- as.factor(d$pwb_b)
pwb_b.tb <- summary(pwb_b.tb)
pwb_b.tb <- as.data.frame(pwb_b.tb)
pwb_b.tb$Var1 <- substring(row.names(pwb_b.tb), 1)
                           
pwb_b.tb$group <- revalue(as.character(pwb_b.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_b <- merge(pwb_b, pwb_b.tb, by = "group")
plot.pwb_b <- plot.pwb_b[-c(2, 4, 6)]
plot.pwb_b <- setcolorder(plot.pwb_b, c("group", "pwb_b.tb", "Freq"))
plot.pwb_b$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_b <- plot.pwb_b %>% arrange(order)
plot.pwb_b <- plot.pwb_b[-c(4)]
colnames(plot.pwb_b) <- c("Response", "N", "Percentage")

kable(plot.pwb_b) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### c. With your health?


```{r}
pwb_c <- round(prop.table(table(factor(d$pwb_c)))*100,2)

pwb_c <- as.data.frame(pwb_c)
pwb_c$group <- substring(row.names(pwb_c), 1)
pwb_c$group <- revalue(as.character(pwb_c$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_c$plot <- factor(pwb_c$group, pwb_c$group)
pwb_c.plot <- ggplot(pwb_c, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_c.plot + geom_histogram(aes(x = plot), data = pwb_c, stat = "identity") 

pwb_c.tb <- as.factor(d$pwb_c)
pwb_c.tb <- summary(pwb_c.tb)
pwb_c.tb <- as.data.frame(pwb_c.tb)
pwb_c.tb$Var1 <- substring(row.names(pwb_c.tb), 1)
                           
pwb_c.tb$group <- revalue(as.character(pwb_c.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_c <- merge(pwb_c, pwb_c.tb, by = "group")
plot.pwb_c <- plot.pwb_c[-c(2, 4, 6)]
plot.pwb_c <- setcolorder(plot.pwb_c, c("group", "pwb_c.tb", "Freq"))
plot.pwb_c$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_c <- plot.pwb_c %>% arrange(order)
plot.pwb_c <- plot.pwb_c[-c(4)]
colnames(plot.pwb_c) <- c("Response", "N", "Percentage")

kable(plot.pwb_c) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### d. With what you are achieving in life?

```{r}
pwb_d <- round(prop.table(table(factor(d$pwb_d)))*100,2)

pwb_d <- as.data.frame(pwb_d)
pwb_d$group <- substring(row.names(pwb_d), 1)
pwb_d$group <- revalue(as.character(pwb_d$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_d$plot <- factor(pwb_d$group, pwb_d$group)
pwb_d.plot <- ggplot(pwb_d, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_d.plot + geom_histogram(aes(x = plot), data = pwb_d, stat = "identity") 

pwb_d.tb <- as.factor(d$pwb_d)
pwb_d.tb <- summary(pwb_d.tb)
pwb_d.tb <- as.data.frame(pwb_d.tb)
pwb_d.tb$Var1 <- substring(row.names(pwb_d.tb), 1)
                           
pwb_d.tb$group <- revalue(as.character(pwb_d.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_d <- merge(pwb_d, pwb_d.tb, by = "group")
plot.pwb_d <- plot.pwb_d[-c(2, 4, 6)]
plot.pwb_d <- setcolorder(plot.pwb_d, c("group", "pwb_d.tb", "Freq"))
plot.pwb_d$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_d <- plot.pwb_d %>% arrange(order)
plot.pwb_d <- plot.pwb_d[-c(4)]
colnames(plot.pwb_d) <- c("Response", "N", "Percentage")

kable(plot.pwb_d) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### e. With your personal relationships?


```{r}
pwb_e <- round(prop.table(table(factor(d$pwb_e)))*100,2)

pwb_e <- as.data.frame(pwb_e)
pwb_e$group <- substring(row.names(pwb_e), 1)
pwb_e$group <- revalue(as.character(pwb_e$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_e$plot <- factor(pwb_e$group, pwb_e$group)
pwb_e.plot <- ggplot(pwb_e, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_e.plot + geom_histogram(aes(x = plot), data = pwb_e, stat = "identity") 

pwb_e.tb <- as.factor(d$pwb_e)
pwb_e.tb <- summary(pwb_e.tb)
pwb_e.tb <- as.data.frame(pwb_e.tb)
pwb_e.tb$Var1 <- substring(row.names(pwb_e.tb), 1)
                           
pwb_e.tb$group <- revalue(as.character(pwb_e.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_e <- merge(pwb_e, pwb_e.tb, by = "group")
plot.pwb_e <- plot.pwb_e[-c(2, 4, 6)]
plot.pwb_e <- setcolorder(plot.pwb_e, c("group", "pwb_e.tb", "Freq"))
plot.pwb_e$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_e <- plot.pwb_e %>% arrange(order)
plot.pwb_e <- plot.pwb_e[-c(4)]
colnames(plot.pwb_e) <- c("Response", "N", "Percentage")

kable(plot.pwb_e) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```
#### f. With how safe you feel?


```{r}
pwb_f <- round(prop.table(table(factor(d$pwb_f)))*100,2)

pwb_f <- as.data.frame(pwb_f)
pwb_f$group <- substring(row.names(pwb_f), 1)
pwb_f$group <- revalue(as.character(pwb_f$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_f$plot <- factor(pwb_f$group, pwb_f$group)
pwb_f.plot <- ggplot(pwb_f, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_f.plot + geom_histogram(aes(x = plot), data = pwb_f, stat = "identity") 

pwb_f.tb <- as.factor(d$pwb_f)
pwb_f.tb <- summary(pwb_f.tb)
pwb_f.tb <- as.data.frame(pwb_f.tb)
pwb_f.tb$Var1 <- substring(row.names(pwb_f.tb), 1)
                           
pwb_f.tb$group <- revalue(as.character(pwb_f.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_f <- merge(pwb_f, pwb_f.tb, by = "group")
plot.pwb_f <- plot.pwb_f[-c(2, 4, 6)]
plot.pwb_f <- setcolorder(plot.pwb_f, c("group", "pwb_f.tb", "Freq"))
plot.pwb_f$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_f <- plot.pwb_f %>% arrange(order)
plot.pwb_f <- plot.pwb_f[-c(4)]
colnames(plot.pwb_f) <- c("Response", "N", "Percentage")

kable(plot.pwb_f) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```
#### g. With feeling part of your community?

```{r}
pwb_g <- round(prop.table(table(factor(d$pwb_g)))*100,2)

pwb_g <- as.data.frame(pwb_g)
pwb_g$group <- substring(row.names(pwb_g), 1)
pwb_g$group <- revalue(as.character(pwb_g$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_g$plot <- factor(pwb_g$group, pwb_g$group)
pwb_g.plot <- ggplot(pwb_g, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_g.plot + geom_histogram(aes(x = plot), data = pwb_g, stat = "identity") 

pwb_g.tb <- as.factor(d$pwb_g)
pwb_g.tb <- summary(pwb_g.tb)
pwb_g.tb <- as.data.frame(pwb_g.tb)
pwb_g.tb$Var1 <- substring(row.names(pwb_g.tb), 1)
                           
pwb_g.tb$group <- revalue(as.character(pwb_g.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_g <- merge(pwb_g, pwb_g.tb, by = "group")
plot.pwb_g <- plot.pwb_g[-c(2, 4, 6)]
plot.pwb_g <- setcolorder(plot.pwb_g, c("group", "pwb_g.tb", "Freq"))
plot.pwb_g$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_g <- plot.pwb_g %>% arrange(order)
plot.pwb_g <- plot.pwb_g[-c(4)]
colnames(plot.pwb_g) <- c("Response", "N", "Percentage")

kable(plot.pwb_g) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### h. With your future security?

```{r}
pwb_h <- round(prop.table(table(factor(d$pwb_h)))*100,2)

pwb_h <- as.data.frame(pwb_h)
pwb_h$group <- substring(row.names(pwb_h), 1)
pwb_h$group <- revalue(as.character(pwb_h$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_h$plot <- factor(pwb_h$group, pwb_h$group)
pwb_h.plot <- ggplot(pwb_h, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_h.plot + geom_histogram(aes(x = plot), data = pwb_h, stat = "identity") 

pwb_h.tb <- as.factor(d$pwb_h)
pwb_h.tb <- summary(pwb_h.tb)
pwb_h.tb <- as.data.frame(pwb_h.tb)
pwb_h.tb$Var1 <- substring(row.names(pwb_h.tb), 1)
                           
pwb_h.tb$group <- revalue(as.character(pwb_h.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_h <- merge(pwb_h, pwb_h.tb, by = "group")
plot.pwb_h <- plot.pwb_h[-c(2, 4, 6)]
plot.pwb_h <- setcolorder(plot.pwb_h, c("group", "pwb_h.tb", "Freq"))
plot.pwb_h$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_h <- plot.pwb_h %>% arrange(order)
plot.pwb_h <- plot.pwb_h[-c(4)]
colnames(plot.pwb_h) <- c("Response", "N", "Percentage")

kable(plot.pwb_h) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### i. With your spirituality or religion?

```{r}
pwb_i <- round(prop.table(table(factor(d$pwb_i)))*100,2)

pwb_i <- as.data.frame(pwb_i)
pwb_i$group <- substring(row.names(pwb_i), 1)
pwb_i$group <- revalue(as.character(pwb_i$group), c("1" = "0- Completely dissatisfied", "2" = "1", "3" = "2", "4" = "3", "5" = "4", "6" = "5", "7" = "6", "8" = "7", "9" = "8", "10" = "9", "11" = "10-Completely satisfied"))

cols <- c((brewer.pal(11,"RdYlGn")))
pwb_i$plot <- factor(pwb_i$group, pwb_i$group)
pwb_i.plot <- ggplot(pwb_i, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols) +
      ylab("Percent of total") +
      xlab("")
      
pwb_i.plot + geom_histogram(aes(x = plot), data = pwb_i, stat = "identity") 

pwb_i.tb <- as.factor(d$pwb_i)
pwb_i.tb <- summary(pwb_i.tb)
pwb_i.tb <- as.data.frame(pwb_i.tb)
pwb_i.tb$Var1 <- substring(row.names(pwb_i.tb), 1)
                           
pwb_i.tb$group <- revalue(as.character(pwb_i.tb$Var1), c("0" = "0- Completely dissatisfied", "10" = "10-Completely satisfied"))

plot.pwb_i <- merge(pwb_i, pwb_i.tb, by = "group")
plot.pwb_i <- plot.pwb_i[-c(2, 4, 6)]
plot.pwb_i <- setcolorder(plot.pwb_i, c("group", "pwb_i.tb", "Freq"))
plot.pwb_i$order <- c(1, 2, 11, 3, 4, 5, 6, 7, 8, 9, 10)
plot.pwb_i <- plot.pwb_i %>% arrange(order)
plot.pwb_i <- plot.pwb_i[-c(4)]
colnames(plot.pwb_i) <- c("Response", "N", "Percentage")

kable(plot.pwb_i) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

### In general, I consider myself:

```{r}
#gwb_a

gwb_a <- round(prop.table(table(factor(d$gwb_a)))*100,2)
gwb_a <- as.data.frame(gwb_a)
gwb_a$group <- substring(row.names(gwb_a), 1)
gwb_a$group <- revalue(as.character(gwb_a$group), c("1" = "1- Not a very happy person", "7" = "7- A very happy person"))
gwb_a$plot <- factor(gwb_a$group, gwb_a$group)

p <- ggplot(gwb_a, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) #order responses as in gwb_a

p + geom_histogram(aes(x = plot), data = gwb_a, stat = "identity") +
  scale_fill_manual(values=INTERACTPalettecont) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("")


gwb_a.tb <- as.factor(d$gwb_a)
gwb_a.tb <- summary(gwb_a.tb)
gwb_a.tb <- as.data.frame(gwb_a.tb)
gwb_a.tb$Var1 <- substring(row.names(gwb_a.tb), 1)
gwb_a.tb$group <- revalue(as.character(gwb_a.tb$Var1), c("1" = "1- Not a very happy person", "7" = "7- A very happy person"))

plot.gwb_a <- merge(gwb_a, gwb_a.tb, by = "group")
plot.gwb_a <- plot.gwb_a[-c(2, 4, 6)]
plot.gwb_a <- setcolorder(plot.gwb_a, c("group", "gwb_a.tb", "Freq"))
colnames(plot.gwb_a) <- c("Response", "N", "Percentage")

kable(plot.gwb_a) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

### Compared with most of my peers, I consider myself:

```{r}
#gwb_b

gwb_b <- round(prop.table(table(factor(d$gwb_b)))*100,2)
gwb_b <- as.data.frame(gwb_b)
gwb_b$group <- substring(row.names(gwb_b), 1)
gwb_b$group <- revalue(as.character(gwb_b$group), c("1" = "1- Less happy", "7" = "7- More happy"))
gwb_b$plot <- factor(gwb_b$group, gwb_b$group)

p <- ggplot(gwb_b, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = gwb_b, stat = "identity") +
  scale_fill_manual(values=INTERACTPalettecont) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") 
      
gwb_b.tb <- as.factor(d$gwb_b)
gwb_b.tb <- summary(gwb_b.tb)
gwb_b.tb <- as.data.frame(gwb_b.tb)
gwb_b.tb$Var1 <- substring(row.names(gwb_b.tb), 1)
gwb_b.tb$group <- revalue(as.character(gwb_b.tb$Var1), c("1" = "1- Less happy", "7" = "7- More happy"))

plot.gwb_b <- merge(gwb_b, gwb_b.tb, by = "group")
plot.gwb_b <- plot.gwb_b[-c(2, 4, 6)]
plot.gwb_b <- setcolorder(plot.gwb_b, c("group", "gwb_b.tb", "Freq"))
colnames(plot.gwb_b) <- c("Response", "N", "Percentage")

kable(plot.gwb_b) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
### Some people are generally very happy. They enjoy life regardless of what is going on, getting the most out of everything. To what extent does this characterization describe you?

```{r}

#gwb_c

gwb_c <- round(prop.table(table(factor(d$gwb_c)))*100,2)
gwb_c <- as.data.frame(gwb_c)
gwb_c$group <- substring(row.names(gwb_c), 1)
gwb_c$group <- revalue(as.character(gwb_c$group), c("1" = "1- Not at all", "7" = "7- A great deal"))
gwb_c$plot <- factor(gwb_c$group, gwb_c$group)

p <- ggplot(gwb_c, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = gwb_c, stat = "identity") +
  scale_fill_manual(values=INTERACTPalettecont) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") 

gwb_c.tb <- as.factor(d$gwb_c)
gwb_c.tb <- summary(gwb_c.tb)
gwb_c.tb <- as.data.frame(gwb_c.tb)
gwb_c.tb$Var1 <- substring(row.names(gwb_c.tb), 1)
gwb_c.tb$group <- revalue(as.character(gwb_c.tb$Var1), c("1" = "1- Not at all", "7" = "7- A great deal"))

plot.gwb_c <- merge(gwb_c, gwb_c.tb, by = "group")
plot.gwb_c <- plot.gwb_c[-c(2, 4, 6)]
plot.gwb_c <- setcolorder(plot.gwb_c, c("group", "gwb_c.tb", "Freq"))
colnames(plot.gwb_c) <- c("Response", "N", "Percentage")

kable(plot.gwb_c) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
### Some people are generally not very happy. Although they are not depressed, they never seem as happy as they might be. To what extent does this characterization describe you?
```{r}

#gwb_d

gwb_d <- round(prop.table(table(factor(d$gwb_d, levels = 1:7)))*100,2)
gwb_d <- as.data.frame(gwb_d)
gwb_d$group <- substring(row.names(gwb_d), 1)
gwb_d$group <- revalue(as.character(gwb_d$group), c("1" = "1- Not at all", "7" = "7- A great deal"))
gwb_d$plot <- factor(gwb_d$group, gwb_d$group)

p <- ggplot(gwb_d, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = gwb_d, stat = "identity") +
  scale_fill_manual(values=INTERACTPalettecont) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("")

gwb_d.tb <- as.factor(d$gwb_d)
gwb_d.tb <- summary(gwb_d.tb)
gwb_d.tb <- as.data.frame(gwb_d.tb)
gwb_d.tb$Var1 <- substring(row.names(gwb_d.tb), 1)
gwb_d.tb$group <- revalue(as.character(gwb_d.tb$Var1), c("1" = "1- Not at all", "7" = "7- A great deal"))

plot.gwb_d <- merge(gwb_d, gwb_d.tb, by = "group")
plot.gwb_d <- plot.gwb_d[-c(2, 4, 6)]
plot.gwb_d <- setcolorder(plot.gwb_d, c("group", "gwb_d.tb", "Freq"))
colnames(plot.gwb_d) <- c("Response", "N", "Percentage")

kable(plot.gwb_d) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### The next questions are about how you feel about different aspects of your life. For each one, tell us how often you feel that way. {.tabset}

#### a. How often do you feel that you lack companionship?

```{r}
#loneliness_a

loneliness_a <- round(prop.table(table(factor(d$loneliness_a, levels = 1:3)))*100,2)
loneliness_a <- as.data.frame(loneliness_a)
loneliness_a$group <- substring(row.names(loneliness_a), 1)
loneliness_a$group <- revalue(as.character(loneliness_a$group), c("1" = "Hardly ever", "2" = "Some of the time", "3" = "Often"))
loneliness_a$plot <- factor(loneliness_a$group, loneliness_a$group)

p <- ggplot(loneliness_a, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = loneliness_a, stat = "identity") +  
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE) +
      ylab("Percent of total") +
      xlab("") +
      ggtitle("How often do you feel that you lack companionship?")

loneliness_a.tb <- as.factor(d$loneliness_a)
loneliness_a.tb <- summary(loneliness_a.tb)
loneliness_a.tb <- as.data.frame(loneliness_a.tb)
loneliness_a.tb$Var1 <- substring(row.names(loneliness_a.tb), 1)
loneliness_a.tb$group <- revalue(as.character(loneliness_a.tb$Var1), c("1" = "Hardly ever", "2" = "Some of the time", "3" = "Often"))

plot.loneliness_a <- merge(loneliness_a, loneliness_a.tb, by = "group")
plot.loneliness_a <- plot.loneliness_a[-c(2, 4, 6)]
plot.loneliness_a <- setcolorder(plot.loneliness_a, c("group", "loneliness_a.tb", "Freq"))
plot.loneliness_a$order <- c(1, 3, 2)
plot.loneliness_a <- plot.loneliness_a %>% arrange(order)
plot.loneliness_a <- plot.loneliness_a[-c(4)]
colnames(plot.loneliness_a) <- c("Response", "N", "Percentage")

kable(plot.loneliness_a) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### b. How often do you feel left out?

```{r}

#loneliness_b

loneliness_b <- round(prop.table(table(factor(d$loneliness_b, levels = 1:3)))*100,2)
loneliness_b <- as.data.frame(loneliness_b)
loneliness_b$group <- substring(row.names(loneliness_b), 1)
loneliness_b$group <- revalue(as.character(loneliness_b$group), c("1" = "Hardly ever", "2" = "Some of the time", "3" = "Often"))
loneliness_b$plot <- factor(loneliness_b$group, loneliness_b$group)

p <- ggplot(loneliness_b, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = loneliness_b, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") +
      ggtitle("How often do you feel left out?")

loneliness_b.tb <- as.factor(d$loneliness_b)
loneliness_b.tb <- summary(loneliness_b.tb)
loneliness_b.tb <- as.data.frame(loneliness_b.tb)
loneliness_b.tb$Var1 <- substring(row.names(loneliness_b.tb), 1)
loneliness_b.tb$group <- revalue(as.character(loneliness_b.tb$Var1), c("1" = "Hardly ever", "2" = "Some of the time", "3" = "Often"))

plot.loneliness_b <- merge(loneliness_b, loneliness_b.tb, by = "group")
plot.loneliness_b <- plot.loneliness_b[-c(2, 4, 6)]
plot.loneliness_b <- setcolorder(plot.loneliness_b, c("group", "loneliness_b.tb", "Freq"))
plot.loneliness_b$order <- c(1, 3, 2)
plot.loneliness_b <- plot.loneliness_b %>% arrange(order)
plot.loneliness_b <- plot.loneliness_b[-c(4)]
colnames(plot.loneliness_b) <- c("Response", "N", "Percentage")

kable(plot.loneliness_b) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### c. How often do you feel isolated from others?

```{r}
#loneliness_c
loneliness_c <- round(prop.table(table(factor(d$loneliness_c, levels = 1:3)))*100,2)
loneliness_c <- as.data.frame(loneliness_c)
loneliness_c$group <- substring(row.names(loneliness_c), 1)
loneliness_c$group <- revalue(as.character(loneliness_c$group), c("1" = "Hardly ever", "2" = "Some of the time", "3" = "Often"))
loneliness_c$plot <- factor(loneliness_c$group, loneliness_c$group)

p <- ggplot(loneliness_c, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = loneliness_c, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") +
      ggtitle("How often do you feel isolated from others?")

loneliness_c.tb <- as.factor(d$loneliness_c)
loneliness_c.tb <- summary(loneliness_c.tb)
loneliness_c.tb <- as.data.frame(loneliness_c.tb)
loneliness_c.tb$Var1 <- substring(row.names(loneliness_c.tb), 1)
loneliness_c.tb$group <- revalue(as.character(loneliness_c.tb$Var1), c("1" = "Hardly ever", "2" = "Some of the time", "3" = "Often"))

plot.loneliness_c <- merge(loneliness_c, loneliness_c.tb, by = "group")
plot.loneliness_c <- plot.loneliness_c[-c(2, 4, 6)]
plot.loneliness_c <- setcolorder(plot.loneliness_c, c("group", "loneliness_c.tb", "Freq"))
plot.loneliness_c$order <- c(1, 3, 2)
plot.loneliness_c <- plot.loneliness_c %>% arrange(order)
plot.loneliness_c <- plot.loneliness_c[-c(4)]
colnames(plot.loneliness_c) <- c("Response", "N", "Percentage")

kable(plot.loneliness_c) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

## Section 5: Social Participation

### How would you describe your sense of belonging to your local community? Would you say it is: 

```{r}

#belonging

## Plot
### Data preparation
belonging <- round(prop.table(table(factor(d$belonging)))*100,2)
belonging <- as.data.frame(belonging)
belonging$group <- substring(row.names(belonging), 1)
belonging$group <- revalue(as.character(belonging$group), c("1" = "Very strong", "2" = "Somewhat strong", "3" = "Somewhat weak", "4" = "Very weak", "5" ="I don't know"))
belonging$group <- factor(belonging$group, belonging$group)

### Create color palette
# myColor <- brewer.pal()
p <- ggplot(belonging, aes(x=group, y=Freq, fill=group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = group), data = belonging, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("Sense of belonging")

## Table
kable(data.frame(Response = c("Very strong", "Somewhat strong", "Somewhat weak", "Very weak", "I don't know"),
           Frequence = as.numeric(table(d$belonging)), Percentage = round(as.numeric(prop.table(table(d$belonging)))*100,2))) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### How often do you. {.tabset}

#### a. Say hello to a neighbour?

```{r}
#spat_a

#per week
ggplot(d, aes(x = d$spat_a/52.1429)) + 
  geom_histogram(binwidth = 1, na.rm = TRUE, fill="#1596FF") + xlab("Times per week")

summary(d$spat_a/52.1429)

```

#### b. Stop and have a chat with a neighbour?

```{r}
#spat_b

#per week
ggplot(d, aes(x = d$spat_b/52.1429)) + 
  geom_histogram(binwidth = 1, na.rm = TRUE, fill="#1596FF") + xlab("Times per week")

summary(d$spat_b/52.1429)

```

#### c. Visit a neighbour, or receive a visit from a neighbour?

```{r}

#spat_c

#per week
ggplot(d, aes(x = d$spat_c/52.1429)) + 
  geom_histogram(binwidth = 1, na.rm = TRUE, fill="#1596FF") + xlab("Times per week")

summary(d$spat_c/52.1429)

```

#### d. Go somewhere (e.g., to a shop; to a restaurant), together with a neighbour?

```{r}

#spat_d

#per week
ggplot(d, aes(x = d$spat_d/52.1429)) + 
  geom_histogram(binwidth = 1, na.rm = TRUE, fill="#1596FF") + xlab("Times per week")

summary(d$spat_d/52.1429)
```

#### e. Ask help/advice from or do you help/give advice to a neighbour yourself?
```{r}

#spat_e

#per week
ggplot(d, aes(x = d$spat_e/52.1429)) + 
  geom_histogram(binwidth = 1, na.rm = TRUE, fill="#1596FF") + xlab("Times per week")

summary(d$spat_e/52.1429)
                     
```


### Thinking about your neighbourhood, how would you rate the following statements? {.tabset}

#### a. This is a close-knit neighbourhood

```{r}
# plot spat2_a

spat2_a <- round(prop.table(table(factor(d$spat2_a)))*100,2)
spat2_a <- as.data.frame(spat2_a)
spat2_a$group <- substring(row.names(spat2_a), 1)
spat2_a$group <- revalue(as.character(spat2_a$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
spat2_a$plot <- factor(spat2_a$group, spat2_a$group)

p <- ggplot(spat2_a, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = spat2_a, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("")

spat2_a.tb <- as.factor(d$spat2_a)
spat2_a.tb <- summary(spat2_a.tb)
spat2_a.tb <- as.data.frame(spat2_a.tb)
spat2_a.tb$Var1 <- substring(row.names(spat2_a.tb), 1)
spat2_a.tb$group <- revalue(as.character(spat2_a.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))

plot.spat2_a.tb <- merge(spat2_a, spat2_a.tb, by = "group")
plot.spat2_a.tb <- plot.spat2_a.tb[-c(2, 4, 6)]
plot.spat2_a.tb <- setcolorder(plot.spat2_a.tb, c("group", "spat2_a.tb", "Freq"))

plot.spat2_a.tb$order <- c(3,4,2,5,1)
plot.spat2_a.tb <- plot.spat2_a.tb %>% arrange(order)
plot.spat2_a.tb <- plot.spat2_a.tb[-c(4)]
colnames(plot.spat2_a.tb) <- c("Response", "N", "Percentage")

kable(plot.spat2_a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")



```

#### b. People generally do not get along

```{r}

# plot spat2_b

spat2_b <- round(prop.table(table(factor(d$spat2_b)))*100,2)
spat2_b <- as.data.frame(spat2_b)
spat2_b$group <- substring(row.names(spat2_b), 1)
spat2_b$group <- revalue(as.character(spat2_b$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
spat2_b$plot <- factor(spat2_b$group, spat2_b$group)

p <- ggplot(spat2_b, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = spat2_b, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total")


spat2_b.tb <- as.factor(d$spat2_b)
spat2_b.tb <- summary(spat2_b.tb)
spat2_b.tb <- as.data.frame(spat2_b.tb)
spat2_b.tb$Var1 <- substring(row.names(spat2_b.tb), 1)
spat2_b.tb$group <- revalue(as.character(spat2_b.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))

plot.spat2_b.tb <- merge(spat2_b, spat2_b.tb, by = "group")
plot.spat2_b.tb <- plot.spat2_b.tb[-c(2, 4, 6)]
plot.spat2_b.tb <- setcolorder(plot.spat2_b.tb, c("group", "spat2_b.tb", "Freq"))

plot.spat2_b.tb$order <- c(3,4,2,5,1)
plot.spat2_b.tb <- plot.spat2_b.tb %>% arrange(order)
plot.spat2_b.tb <- plot.spat2_b.tb[-c(4)]
colnames(plot.spat2_b.tb) <- c("Response", "N", "Percentage")

kable(plot.spat2_b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```
#### c. People are willing to help neighbours

```{r}

# plot spat2_c
spat2_c <- round(prop.table(table(factor(d$spat2_c)))*100,2)
spat2_c <- as.data.frame(spat2_c)
spat2_c$group <- substring(row.names(spat2_c), 1)
spat2_c$group <- revalue(as.character(spat2_c$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
spat2_c$plot <- factor(spat2_c$group, spat2_c$group)

p <- ggplot(spat2_c, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = spat2_c, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") 


spat2_c.tb <- as.factor(d$spat2_c)
spat2_c.tb <- summary(spat2_c.tb)
spat2_c.tb <- as.data.frame(spat2_c.tb)
spat2_c.tb$Var1 <- substring(row.names(spat2_c.tb), 1)
spat2_c.tb$group <- revalue(as.character(spat2_c.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))

plot.spat2_c.tb <- merge(spat2_c, spat2_c.tb, by = "group")
plot.spat2_c.tb <- plot.spat2_c.tb[-c(2, 4, 6)]
plot.spat2_c.tb <- setcolorder(plot.spat2_c.tb, c("group", "spat2_c.tb", "Freq"))

plot.spat2_c.tb$order <- c(3,4,2,5,1)
plot.spat2_c.tb <- plot.spat2_c.tb %>% arrange(order)
plot.spat2_c.tb <- plot.spat2_c.tb[-c(4)]
colnames(plot.spat2_c.tb) <- c("Response", "N", "Percentage")

kable(plot.spat2_c.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### d. People do not share same values
```{r}

# plot spat2_d

spat2_d <- round(prop.table(table(factor(d$spat2_d)))*100,2)
spat2_d <- as.data.frame(spat2_d)
spat2_d$group <- substring(row.names(spat2_d), 1)
spat2_d$group <- revalue(as.character(spat2_d$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
spat2_d$plot <- factor(spat2_d$group, spat2_d$group)

p <- ggplot(spat2_d, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = spat2_d, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") 


spat2_d.tb <- as.factor(d$spat2_d)
spat2_d.tb <- summary(spat2_d.tb)
spat2_d.tb <- as.data.frame(spat2_d.tb)
spat2_d.tb$Var1 <- substring(row.names(spat2_d.tb), 1)
spat2_d.tb$group <- revalue(as.character(spat2_d.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))

plot.spat2_d.tb <- merge(spat2_d, spat2_d.tb, by = "group")
plot.spat2_d.tb <- plot.spat2_d.tb[-c(2, 4, 6)]
plot.spat2_d.tb <- setcolorder(plot.spat2_d.tb, c("group", "spat2_d.tb", "Freq"))

plot.spat2_d.tb$order <- c(3,4,2,5,1)
plot.spat2_d.tb <- plot.spat2_d.tb %>% arrange(order)
plot.spat2_d.tb <- plot.spat2_d.tb[-c(4)]
colnames(plot.spat2_d.tb) <- c("Response", "N", "Percentage")

kable(plot.spat2_d.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### e. People can be trusted
```{r}

# plot spat2_e

spat2_e <- round(prop.table(table(factor(d$spat2_e)))*100,2)
spat2_e <- as.data.frame(spat2_e)
spat2_e$group <- substring(row.names(spat2_e), 1)
spat2_e$group <- revalue(as.character(spat2_e$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
spat2_e$plot <- factor(spat2_e$group, spat2_e$group)

p <- ggplot(spat2_e, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = spat2_e, stat = "identity") +
  scale_fill_manual(values=INTERACTPalette3) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") 


spat2_e.tb <- as.factor(d$spat2_e)
spat2_e.tb <- summary(spat2_e.tb)
spat2_e.tb <- as.data.frame(spat2_e.tb)
spat2_e.tb$Var1 <- substring(row.names(spat2_e.tb), 1)
spat2_e.tb$group <- revalue(as.character(spat2_e.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))

plot.spat2_e.tb <- merge(spat2_e, spat2_e.tb, by = "group")
plot.spat2_e.tb <- plot.spat2_e.tb[-c(2, 4, 6)]
plot.spat2_e.tb <- setcolorder(plot.spat2_e.tb, c("group", "spat2_e.tb", "Freq"))

plot.spat2_e.tb$order <- c(3,4,2,5,1)
plot.spat2_e.tb <- plot.spat2_e.tb %>% arrange(order)
plot.spat2_e.tb <- plot.spat2_e.tb[-c(4)]
colnames(plot.spat2_e.tb) <- c("Response", "N", "Percentage")

kable(plot.spat2_e.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```


### If you lost a wallet or purse that contained two hundred dollars, how likely is it to be returned with the money in it, if it was found: {.tabset}

#### a. By someone who lives close by? Would it be:

```{r}

#spat3_a

spat3_a <- round(prop.table(table(factor(d$spat3_a)))*100,2)
spat3_a <- as.data.frame(spat3_a)
spat3_a$group <- substring(row.names(spat3_a), 1)
spat3_a$group <- revalue(as.character(spat3_a$group), c("1"="Very likely", "2"="Somewhat likely", "3"="Not at all likely", "4"="I don't know"))
spat3_a$plot <- factor(spat3_a$group, spat3_a$group)

p <- ggplot(spat3_a, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = spat3_a, stat = "identity") +
  scale_fill_manual(values=INTERACTshortfade) +
      guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") +
      ggtitle("By someone who lives close by?")+ 
      theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
spat3_a.tb <- as.factor(d$spat3_a)
spat3_a.tb <- summary(spat3_a.tb)
spat3_a.tb <- as.data.frame(spat3_a.tb)
spat3_a.tb$Var1 <- substring(row.names(spat3_a.tb), 1)
spat3_a.tb$group <- revalue(as.character(spat3_a.tb$Var1), c("1"="Very likely", "2"="Somewhat likely", "3"="Not at all likely", "77"="I don't know"))


## merge with existing prop table data used for plot above 
plot.spat3_a.tb <- merge(spat3_a, spat3_a.tb, by = "group")
plot.spat3_a.tb <- plot.spat3_a.tb[-c(2, 4, 6)]
plot.spat3_a.tb <- setcolorder(plot.spat3_a.tb, c("group", "spat3_a.tb", "Freq"))

plot.spat3_a.tb$order <- c(4,3,2,1)
plot.spat3_a.tb <- plot.spat3_a.tb %>% arrange(order)
plot.spat3_a.tb <- plot.spat3_a.tb[-c(4)]
colnames(plot.spat3_a.tb) <- c("Response", "N", "Percentage")

kable(plot.spat3_a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### b. By a complete stranger? Would it be:

```{r}

#spat3_b
spat3_b <- round(prop.table(table(factor(d$spat3_b)))*100,2)
spat3_b <- as.data.frame(spat3_b)
spat3_b$group <- substring(row.names(spat3_b), 1)
spat3_b$group <- revalue(as.character(spat3_b$group), c("1"="Very likely", "2"="Somewhat likely", "3"="Not at all likely", "4"="I don't know"))
spat3_b$plot <- factor(spat3_b$group, spat3_b$group)

p <- ggplot(spat3_b, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = spat3_b, stat = "identity") +
  scale_fill_manual(values=INTERACTshortfade) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("") +
      ggtitle("By a complete stranger?")+ 
      theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
spat3_b.tb <- as.factor(d$spat3_b)
spat3_b.tb <- summary(spat3_b.tb)
spat3_b.tb <- as.data.frame(spat3_b.tb)
spat3_b.tb$Var1 <- substring(row.names(spat3_b.tb), 1)
spat3_b.tb$group <- revalue(as.character(spat3_b.tb$Var1), c("1"="Very likely", "2"="Somewhat likely", "3"="Not at all likely", "77"="I don't know"))


## merge with existing prop table data used for plot above 
plot.spat3_b.tb <- merge(spat3_b, spat3_b.tb, by = "group")
plot.spat3_b.tb <- plot.spat3_b.tb[-c(2, 4, 6)]
plot.spat3_b.tb <- setcolorder(plot.spat3_b.tb, c("group", "spat3_b.tb", "Freq"))

plot.spat3_b.tb$order <- c(4,3,2,1)
plot.spat3_b.tb <- plot.spat3_b.tb %>% arrange(order)
plot.spat3_b.tb <- plot.spat3_b.tb[-c(4)]
colnames(plot.spat3_b.tb) <- c("Response", "N", "Percentage")

kable(plot.spat3_b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### Here are some questions about your satisfaction with the neighbourhood in which you live. Please indicate your satisfaction with each item.How satisfied are you with... {.tabset}

#### a. your neighbourhood as a good place to live?

```{r}
#neighb_a

neighb_a <- round(prop.table(table(factor(d$neighb_a)))*100,2)
neighb_a <- as.data.frame(neighb_a)
neighb_a$group <- substring(row.names(neighb_a), 1)
neighb_a$group <- revalue(as.character(neighb_a$group), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))

neighb_a$plot <- factor(neighb_a$group, neighb_a$group)
cols <- c(rev(brewer.pal(5,"RdYlGn")),"grey")
neighb_a.plot <- ggplot(neighb_a, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols)  +
      ylab("Percent of total") +
      xlab("")
      
neighb_a.plot + geom_histogram(aes(x = plot), data = neighb_a, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
neighb_a.tb <- as.factor(d$neighb_a)
neighb_a.tb <- summary(neighb_a.tb)
neighb_a.tb <- as.data.frame(neighb_a.tb)
neighb_a.tb$Var1 <- substring(row.names(neighb_a.tb), 1)
neighb_a.tb$group <- revalue(as.character(neighb_a.tb$Var1), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))


## merge with existing prop table data used for plot above 
plot.neighb_a.tb <- merge(neighb_a, neighb_a.tb, by = "group")
plot.neighb_a.tb <- plot.neighb_a.tb[-c(2, 4, 6)]
plot.neighb_a.tb <- setcolorder(plot.neighb_a.tb, c("group", "neighb_a.tb", "Freq"))

plot.neighb_a.tb$order <- c(4,3,2,5,1)
plot.neighb_a.tb <- plot.neighb_a.tb %>% arrange(order)
plot.neighb_a.tb <- plot.neighb_a.tb[-c(4)]
colnames(plot.neighb_a.tb) <- c("Response", "N", "Percentage")

kable(plot.neighb_a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### b. the number of people you know in your neighbourhood? 

```{r}
#neighb_b

neighb_b <- round(prop.table(table(factor(d$neighb_b)))*100,2)
neighb_b <- as.data.frame(neighb_b)
neighb_b$group <- substring(row.names(neighb_b), 1)
neighb_b$group <- revalue(as.character(neighb_b$group), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))

neighb_b$plot <- factor(neighb_b$group, neighb_b$group)
cols <- c(rev(brewer.pal(5,"RdYlGn")),"grey")
neighb_b.plot <- ggplot(neighb_b, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols)  +
      ylab("Percent of total") +
      xlab("")
      
neighb_b.plot + geom_histogram(aes(x = plot), data = neighb_b, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
neighb_b.tb <- as.factor(d$neighb_b)
neighb_b.tb <- summary(neighb_b.tb)
neighb_b.tb <- as.data.frame(neighb_b.tb)
neighb_b.tb$Var1 <- substring(row.names(neighb_b.tb), 1)
neighb_b.tb$group <- revalue(as.character(neighb_b.tb$Var1), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))


## merge with existing prop table data used for plot above 
plot.neighb_b.tb <- merge(neighb_b, neighb_b.tb, by = "group")
plot.neighb_b.tb <- plot.neighb_b.tb[-c(2, 4, 6)]
plot.neighb_b.tb <- setcolorder(plot.neighb_b.tb, c("group", "neighb_b.tb", "Freq"))

plot.neighb_b.tb$order <- c(4,3,2,5,1)
plot.neighb_b.tb <- plot.neighb_b.tb %>% arrange(order)
plot.neighb_b.tb <- plot.neighb_b.tb[-c(4)]
colnames(plot.neighb_b.tb) <- c("Response", "N", "Percentage")

kable(plot.neighb_b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### c. the ethnic diversity of your neighbourhood? 
```{r}
#neighb_c

neighb_c <- round(prop.table(table(factor(d$neighb_c)))*100,2)
neighb_c <- as.data.frame(neighb_c)
neighb_c$group <- substring(row.names(neighb_c), 1)
neighb_c$group <- revalue(as.character(neighb_c$group), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))

neighb_c$plot <- factor(neighb_c$group, neighb_c$group)
cols <- c(rev(brewer.pal(5,"RdYlGn")),"grey")
neighb_c.plot <- ggplot(neighb_c, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols)  +
      ylab("Percent of total") +
      xlab("")
      
neighb_c.plot + geom_histogram(aes(x = plot), data = neighb_c, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
neighb_c.tb <- as.factor(d$neighb_c)
neighb_c.tb <- summary(neighb_c.tb)
neighb_c.tb <- as.data.frame(neighb_c.tb)
neighb_c.tb$Var1 <- substring(row.names(neighb_c.tb), 1)
neighb_c.tb$group <- revalue(as.character(neighb_c.tb$Var1), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))


## merge with existing prop table data used for plot above 
plot.neighb_c.tb <- merge(neighb_c, neighb_c.tb, by = "group")
plot.neighb_c.tb <- plot.neighb_c.tb[-c(2, 4, 6)]
plot.neighb_c.tb <- setcolorder(plot.neighb_c.tb, c("group", "neighb_c.tb", "Freq"))

plot.neighb_c.tb$order <- c(4,3,2,5,1)
plot.neighb_c.tb <- plot.neighb_c.tb %>% arrange(order)
plot.neighb_c.tb <- plot.neighb_c.tb[-c(4)]
colnames(plot.neighb_c.tb) <- c("Response", "N", "Percentage")

kable(plot.neighb_c.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### d. your neighbourhood as a good place to raise children

```{r}
#neighb_d

neighb_d <- round(prop.table(table(factor(d$neighb_d)))*100,2)
neighb_d <- as.data.frame(neighb_d)
neighb_d$group <- substring(row.names(neighb_d), 1)
neighb_d$group <- revalue(as.character(neighb_d$group), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))

neighb_d$plot <- factor(neighb_d$group, neighb_d$group)
cols <- c(rev(brewer.pal(5,"RdYlGn")),"grey")
neighb_d.plot <- ggplot(neighb_d, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = cols)  +
      ylab("Percent of total") +
      xlab("")
      
neighb_d.plot + geom_histogram(aes(x = plot), data = neighb_d, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
neighb_d.tb <- as.factor(d$neighb_d)
neighb_d.tb <- summary(neighb_d.tb)
neighb_d.tb <- as.data.frame(neighb_d.tb)
neighb_d.tb$Var1 <- substring(row.names(neighb_d.tb), 1)
neighb_d.tb$group <- revalue(as.character(neighb_d.tb$Var1), c("1" = "Strongly satisfied", "2" = "Satisfied", "3" = "Neither satisfied nor dissatisfied", "4" = "Dissatisfied", "5" = "Strongly dissatisfied"))


## merge with existing prop table data used for plot above 
plot.neighb_d.tb <- merge(neighb_d, neighb_d.tb, by = "group")
plot.neighb_d.tb <- plot.neighb_d.tb[-c(2, 4, 6)]
plot.neighb_d.tb <- setcolorder(plot.neighb_d.tb, c("group", "neighb_d.tb", "Freq"))

plot.neighb_d.tb$order <- c(4,3,2,5,1)
plot.neighb_d.tb <- plot.neighb_d.tb %>% arrange(order)
plot.neighb_d.tb <- plot.neighb_d.tb[-c(4)]
colnames(plot.neighb_d.tb) <- c("Response", "N", "Percentage")

kable(plot.neighb_d.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```


### To what extent do you agree with the following statements? {.tabset}

#### a. People feel that neighbourhood efforts to improve this area are a waste of time.

```{r}

#rds_a

rds_a <- round(prop.table(table(factor(d$rds_a)))*100,2)
rds_a <- as.data.frame(rds_a)
rds_a$group <- substring(row.names(rds_a), 1)
rds_a$group <- revalue(as.character(rds_a$group), c("1" = "1 - Strongly disagree", "10" = "10 - Strongly agree"))
rds_a$plot <- factor(rds_a$group, rds_a$group)

cols <- c((brewer.pal(10,"RdYlGn")),"grey")
rds_a.plot <- ggplot(rds_a, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

rds_a.plot + geom_histogram(aes(x = plot), data = rds_a, stat = "identity") 


# make a clean summary table 
## make a dataframe on count 
rds_a.tb <- as.factor(d$rds_a)
rds_a.tb <- summary(rds_a.tb)
rds_a.tb <- as.data.frame(rds_a.tb)
rds_a.tb$Var1 <- substring(row.names(rds_a.tb), 1)
rds_a.tb$group <- revalue(as.character(rds_a.tb$Var1), c("1" = "1 - Strongly disagree", "10" = "10 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.rds_a.tb <- merge(rds_a, rds_a.tb, by = "group")
plot.rds_a.tb <- plot.rds_a.tb[-c(2, 4, 6)]
plot.rds_a.tb <- setcolorder(plot.rds_a.tb, c("group", "rds_a.tb", "Freq"))

plot.rds_a.tb$order <- c(1,10,2,3,4,5,6,7,8,9)
plot.rds_a.tb <- plot.rds_a.tb %>% arrange(order)
plot.rds_a.tb <- plot.rds_a.tb[-c(4)]
colnames(plot.rds_a.tb) <- c("Response", "N", "Percentage")

kable(plot.rds_a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 


```

#### b. When something needs to be improved in the neighbourhood, people from outside the neighbourhood are more likely to do something about it than people from inside the neighbourhood.

```{r}

#rds_b

rds_b <- round(prop.table(table(factor(d$rds_b)))*100,2)
rds_b <- as.data.frame(rds_b)
rds_b$group <- substring(row.names(rds_b), 1)
rds_b$group <- revalue(as.character(rds_b$group), c("1" = "1 - Strongly disagree", "10" = "10 - Strongly agree"))

rds_b$plot <- factor(rds_b$group, rds_b$group)
cols <- c((brewer.pal(10,"RdYlGn")),"grey")
rds_b.plot <- ggplot(rds_b, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

rds_b.plot + geom_histogram(aes(x = plot), data = rds_b, stat = "identity") 


# make a clean summary table 
## make a dataframe on count 
rds_b.tb <- as.factor(d$rds_b)
rds_b.tb <- summary(rds_b.tb)
rds_b.tb <- as.data.frame(rds_b.tb)
rds_b.tb$Var1 <- substring(row.names(rds_b.tb), 1)
rds_b.tb$group <- revalue(as.character(rds_b.tb$Var1), c("1" = "1 - Strongly disagree", "10" = "10 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.rds_b.tb <- merge(rds_b, rds_b.tb, by = "group")
plot.rds_b.tb <- plot.rds_b.tb[-c(2, 4, 6)]
plot.rds_b.tb <- setcolorder(plot.rds_b.tb, c("group", "rds_b.tb", "Freq"))

plot.rds_b.tb$order <- c(1,10,2,3,4,5,6,7,8,9)
plot.rds_b.tb <- plot.rds_b.tb %>% arrange(order)
plot.rds_b.tb <- plot.rds_b.tb[-c(4)]
colnames(plot.rds_b.tb) <- c("Response", "N", "Percentage")

kable(plot.rds_b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

#### c. The people in this neighbourhood have almost no influence over what happens here.

```{r}

#rds_c

rds_c <- round(prop.table(table(factor(d$rds_c)))*100,2)
rds_c <- as.data.frame(rds_c)
rds_c$group <- substring(row.names(rds_c), 1)
rds_c$group <- revalue(as.character(rds_c$group), c("1" = "1 - Strongly disagree", "10" = "10 - Strongly agree"))

rds_c$plot <- factor(rds_c$group, rds_c$group)
cols <- c((brewer.pal(10,"RdYlGn")),"grey")
rds_c.plot <- ggplot(rds_c, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

rds_c.plot + geom_histogram(aes(x = plot), data = rds_c, stat = "identity") 


# make a clean summary table 
## make a dataframe on count 
rds_c.tb <- as.factor(d$rds_c)
rds_c.tb <- summary(rds_c.tb)
rds_c.tb <- as.data.frame(rds_c.tb)
rds_c.tb$Var1 <- substring(row.names(rds_c.tb), 1)
rds_c.tb$group <- revalue(as.character(rds_c.tb$Var1), c("1" = "1 - Strongly disagree", "10" = "10 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.rds_c.tb <- merge(rds_c, rds_c.tb, by = "group")
plot.rds_c.tb <- plot.rds_c.tb[-c(2, 4, 6)]
plot.rds_c.tb <- setcolorder(plot.rds_c.tb, c("group", "rds_c.tb", "Freq"))

plot.rds_c.tb$order <- c(1,10,2,3,4,5,6,7,8,9)
plot.rds_c.tb <- plot.rds_c.tb %>% arrange(order)
plot.rds_c.tb <- plot.rds_c.tb[-c(4)]
colnames(plot.rds_c.tb) <- c("Response", "N", "Percentage")

kable(plot.rds_c.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```


### To what extent do you agree with the following statements? {.tabset}


#### a. Most people in this area can be trusted

```{r}
#pnc_a

pnc_a <- round(prop.table(table(factor(d$pnc_a)))*100,2)
pnc_a <- as.data.frame(pnc_a)
pnc_a$group <- substring(row.names(pnc_a), 1)
pnc_a$group <- revalue(as.character(pnc_a$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_a$plot <- factor(pnc_a$group, pnc_a$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_a.plot <- ggplot(pnc_a, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_a.plot + geom_histogram(aes(x = plot), data = pnc_a, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_a.tb <- as.factor(d$pnc_a)
pnc_a.tb <- summary(pnc_a.tb)
pnc_a.tb <- as.data.frame(pnc_a.tb)
pnc_a.tb$Var1 <- substring(row.names(pnc_a.tb), 1)
pnc_a.tb$group <- revalue(as.character(pnc_a.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_a.tb <- merge(pnc_a, pnc_a.tb, by = "group")
plot.pnc_a.tb <- plot.pnc_a.tb[-c(2, 4, 6)]
plot.pnc_a.tb <- setcolorder(plot.pnc_a.tb, c("group", "pnc_a.tb", "Freq"))

colnames(plot.pnc_a.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### b. People in this area will take advantage of you

```{r}

#pnc_b
pnc_b <- round(prop.table(table(factor(d$pnc_b)))*100,2)
pnc_b <- as.data.frame(pnc_b)
pnc_b$group <- substring(row.names(pnc_b), 1)
pnc_b$group <- revalue(as.character(pnc_b$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_b$plot <- factor(pnc_b$group, pnc_b$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_b.plot <- ggplot(pnc_b, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_b.plot + geom_histogram(aes(x = plot), data = pnc_b, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_b.tb <- as.factor(d$pnc_b)
pnc_b.tb <- summary(pnc_b.tb)
pnc_b.tb <- as.data.frame(pnc_b.tb)
pnc_b.tb$Var1 <- substring(row.names(pnc_b.tb), 1)
pnc_b.tb$group <- revalue(as.character(pnc_b.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_b.tb <- merge(pnc_b, pnc_b.tb, by = "group")
plot.pnc_b.tb <- plot.pnc_b.tb[-c(2, 4, 6)]
plot.pnc_b.tb <- setcolorder(plot.pnc_b.tb, c("group", "pnc_b.tb", "Freq"))

colnames(plot.pnc_b.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### c. If you were in trouble, there are lots of people who would help you

```{r}
#pnc_c
pnc_c <- round(prop.table(table(factor(d$pnc_c)))*100,2)
pnc_c <- as.data.frame(pnc_c)
pnc_c$group <- substring(row.names(pnc_c), 1)
pnc_c$group <- revalue(as.character(pnc_c$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_c$plot <- factor(pnc_c$group, pnc_c$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_c.plot <- ggplot(pnc_c, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_c.plot + geom_histogram(aes(x = plot), data = pnc_c, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_c.tb <- as.factor(d$pnc_c)
pnc_c.tb <- summary(pnc_c.tb)
pnc_c.tb <- as.data.frame(pnc_c.tb)
pnc_c.tb$Var1 <- substring(row.names(pnc_c.tb), 1)
pnc_c.tb$group <- revalue(as.character(pnc_c.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_c.tb <- merge(pnc_c, pnc_c.tb, by = "group")
plot.pnc_c.tb <- plot.pnc_c.tb[-c(2, 4, 6)]
plot.pnc_c.tb <- setcolorder(plot.pnc_c.tb, c("group", "pnc_c.tb", "Freq"))

colnames(plot.pnc_c.tb) <- c("Response", "N", "Percentage")
 
kable(plot.pnc_c.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```
#### d. Most people in this area are friendly
```{r}

#pnc_d
pnc_d <- round(prop.table(table(factor(d$pnc_d)))*100,2)
pnc_d <- as.data.frame(pnc_d)
pnc_d$group <- substring(row.names(pnc_d), 1)
pnc_d$group <- revalue(as.character(pnc_d$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))
pnc_d$plot <- factor(pnc_d$group, pnc_d$group)

cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_d.plot <- ggplot(pnc_d, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_d.plot + geom_histogram(aes(x = plot), data = pnc_d, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_d.tb <- as.factor(d$pnc_d)
pnc_d.tb <- summary(pnc_d.tb)
pnc_d.tb <- as.data.frame(pnc_d.tb)
pnc_d.tb$Var1 <- substring(row.names(pnc_d.tb), 1)
pnc_d.tb$group <- revalue(as.character(pnc_d.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_d.tb <- merge(pnc_d, pnc_d.tb, by = "group")
plot.pnc_d.tb <- plot.pnc_d.tb[-c(2, 4, 6)]
plot.pnc_d.tb <- setcolorder(plot.pnc_d.tb, c("group", "pnc_d.tb", "Freq"))

colnames(plot.pnc_d.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_d.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### e. People in this area have lots of com munity spirit
```{r}


#pnc_e
pnc_e <- round(prop.table(table(factor(d$pnc_e)))*100,2)
pnc_e <- as.data.frame(pnc_e)
pnc_e$group <- substring(row.names(pnc_e), 1)
pnc_e$group <- revalue(as.character(pnc_e$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_e$plot <- factor(pnc_e$group, pnc_e$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_e.plot <- ggplot(pnc_e, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_e.plot + geom_histogram(aes(x = plot), data = pnc_e, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_e.tb <- as.factor(d$pnc_e)
pnc_e.tb <- summary(pnc_e.tb)
pnc_e.tb <- as.data.frame(pnc_e.tb)
pnc_e.tb$Var1 <- substring(row.names(pnc_e.tb), 1)
pnc_e.tb$group <- revalue(as.character(pnc_e.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_e.tb <- merge(pnc_e, pnc_e.tb, by = "group")
plot.pnc_e.tb <- plot.pnc_e.tb[-c(2, 4, 6)]
plot.pnc_e.tb <- setcolorder(plot.pnc_e.tb, c("group", "pnc_e.tb", "Freq"))

colnames(plot.pnc_e.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_e.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### f. People in this area do things to help the community
```{r}

#pnc_f
pnc_f <- round(prop.table(table(factor(d$pnc_f)))*100,2)
pnc_f <- as.data.frame(pnc_f)
pnc_f$group <- substring(row.names(pnc_f), 1)
pnc_f$group <- revalue(as.character(pnc_f$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_f$plot <- factor(pnc_f$group, pnc_f$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_f.plot <- ggplot(pnc_f, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_f.plot + geom_histogram(aes(x = plot), data = pnc_f, stat = "identity")

# make a clean summary table 
## make a dataframe on count 
pnc_f.tb <- as.factor(d$pnc_f)
pnc_f.tb <- summary(pnc_f.tb)
pnc_f.tb <- as.data.frame(pnc_f.tb)
pnc_f.tb$Var1 <- substring(row.names(pnc_f.tb), 1)
pnc_f.tb$group <- revalue(as.character(pnc_f.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_f.tb <- merge(pnc_f, pnc_f.tb, by = "group")
plot.pnc_f.tb <- plot.pnc_f.tb[-c(2, 4, 6)]
plot.pnc_f.tb <- setcolorder(plot.pnc_f.tb, c("group", "pnc_f.tb", "Freq"))

colnames(plot.pnc_f.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_f.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### g. People in this area treat each other with respect
```{r}

#pnc_g
pnc_g <- round(prop.table(table(factor(d$pnc_g)))*100,2)
pnc_g <- as.data.frame(pnc_g)
pnc_g$group <- substring(row.names(pnc_g), 1)
pnc_g$group <- revalue(as.character(pnc_g$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_g$plot <- factor(pnc_g$group, pnc_g$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_g.plot <- ggplot(pnc_g, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_g.plot + geom_histogram(aes(x = plot), data = pnc_g, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_g.tb <- as.factor(d$pnc_g)
pnc_g.tb <- summary(pnc_g.tb)
pnc_g.tb <- as.data.frame(pnc_g.tb)
pnc_g.tb$Var1 <- substring(row.names(pnc_g.tb), 1)
pnc_g.tb$group <- revalue(as.character(pnc_g.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_g.tb <- merge(pnc_g, pnc_g.tb, by = "group")
plot.pnc_g.tb <- plot.pnc_g.tb[-c(2, 4, 6)]
plot.pnc_g.tb <- setcolorder(plot.pnc_g.tb, c("group", "pnc_g.tb", "Freq"))

colnames(plot.pnc_g.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_g.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

#### h. People in this area are tolerant of others who are not like them
```{r}

#pnc_h
pnc_h <- round(prop.table(table(factor(d$pnc_h)))*100,2)
pnc_h <- as.data.frame(pnc_h)
pnc_h$group <- substring(row.names(pnc_h), 1)
pnc_h$group <- revalue(as.character(pnc_h$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_h$plot <- factor(pnc_h$group, pnc_h$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_h.plot <- ggplot(pnc_h, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_h.plot + geom_histogram(aes(x = plot), data = pnc_h, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_h.tb <- as.factor(d$pnc_h)
pnc_h.tb <- summary(pnc_h.tb)
pnc_h.tb <- as.data.frame(pnc_h.tb)
pnc_h.tb$Var1 <- substring(row.names(pnc_h.tb), 1)
pnc_h.tb$group <- revalue(as.character(pnc_h.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_h.tb <- merge(pnc_h, pnc_h.tb, by = "group")
plot.pnc_h.tb <- plot.pnc_h.tb[-c(2, 4, 6)]
plot.pnc_h.tb <- setcolorder(plot.pnc_h.tb, c("group", "pnc_h.tb", "Freq"))

colnames(plot.pnc_h.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_h.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### i. In this area there are people who belong and some who don't

```{r}

#pnc_i
pnc_i <- round(prop.table(table(factor(d$pnc_i)))*100,2)
pnc_i <- as.data.frame(pnc_i)
pnc_i$group <- substring(row.names(pnc_i), 1)
pnc_i$group <- revalue(as.character(pnc_i$group), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))

pnc_i$plot <- factor(pnc_i$group, pnc_i$group)
cols <- c((brewer.pal(7,"RdYlGn")),"grey")
pnc_i.plot <- ggplot(pnc_i, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = cols)  +
  ylab("Percent of total") +
  xlab("")

pnc_i.plot + geom_histogram(aes(x = plot), data = pnc_i, stat = "identity") 

# make a clean summary table 
## make a dataframe on count 
pnc_i.tb <- as.factor(d$pnc_i)
pnc_i.tb <- summary(pnc_i.tb)
pnc_i.tb <- as.data.frame(pnc_i.tb)
pnc_i.tb$Var1 <- substring(row.names(pnc_i.tb), 1)
pnc_i.tb$group <- revalue(as.character(pnc_i.tb$Var1), c("1" = "1 - Strongly disagree", "7" = "7 - Strongly agree"))


## merge with existing prop table data used for plot above 
plot.pnc_i.tb <- merge(pnc_i, pnc_i.tb, by = "group")
plot.pnc_i.tb <- plot.pnc_i.tb[-c(2, 4, 6)]
plot.pnc_i.tb <- setcolorder(plot.pnc_i.tb, c("group", "pnc_i.tb", "Freq"))

colnames(plot.pnc_i.tb) <- c("Response", "N", "Percentage")

kable(plot.pnc_i.tb)%>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```


### To what extent do you agree with the following statements? {.tabset} 


#### I can get what I need in this neighbourhood

```{r}
#Plot sci_a

sci_a <- round(prop.table(table(factor(d$sci_a)))*100,2)
sci_a <- as.data.frame(sci_a)
sci_a$group <- substring(row.names(sci_a), 1)
sci_a$group <- revalue(as.character(sci_a$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_a$plot <- factor(sci_a$group, sci_a$group)

p <- ggplot(sci_a, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

cols <- c(brewer.pal(5,"RdYlGn"))

p + geom_histogram(aes(x = plot), data = sci_a, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("I can get what I need in this neighbourhood")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_a.tb <- as.factor(d$sci_a)
sci_a.tb <- summary(sci_a.tb)
sci_a.tb <- as.data.frame(sci_a.tb)
sci_a.tb$Var1 <- substring(row.names(sci_a.tb), 1)
sci_a.tb$group <- revalue(as.character(sci_a.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_a.tb <- merge(sci_a, sci_a.tb, by = "group")
plot.sci_a.tb <- plot.sci_a.tb[-c(2, 4, 6)]
plot.sci_a.tb <- setcolorder(plot.sci_a.tb, c("group", "sci_a.tb", "Freq"))

plot.sci_a.tb$order <- c(3,4,2,5,1)
plot.sci_a.tb <- plot.sci_a.tb %>% arrange(order)
plot.sci_a.tb <- plot.sci_a.tb[-c(4)]
colnames(plot.sci_a.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### This neighbourhood helps me fulfill my needs 

```{r}

#Plot sci_b
sci_b <- round(prop.table(table(factor(d$sci_b)))*100,2)
sci_b <- as.data.frame(sci_b)
sci_b$group <- substring(row.names(sci_b), 1)
sci_b$group <- revalue(as.character(sci_b$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_b$plot <- factor(sci_b$group, sci_b$group)

p <- ggplot(sci_b, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 
cols <- c(brewer.pal(5,"RdYlGn"))
p + geom_histogram(aes(x = plot), data = sci_b, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("This neighbourhood helps me fulfill my needs")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_b.tb <- as.factor(d$sci_b)
sci_b.tb <- summary(sci_b.tb)
sci_b.tb <- as.data.frame(sci_b.tb)
sci_b.tb$Var1 <- substring(row.names(sci_b.tb), 1)
sci_b.tb$group <- revalue(as.character(sci_b.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_b.tb <- merge(sci_b, sci_b.tb, by = "group")
plot.sci_b.tb <- plot.sci_b.tb[-c(2, 4, 6)]
plot.sci_b.tb <- setcolorder(plot.sci_b.tb, c("group", "sci_b.tb", "Freq"))

plot.sci_b.tb$order <- c(3,4,2,5,1)
plot.sci_b.tb <- plot.sci_b.tb %>% arrange(order)
plot.sci_b.tb <- plot.sci_b.tb[-c(4)]
colnames(plot.sci_b.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### I feel like a member of this neighbourhood 
```{r}

#Plot sci_c
sci_c <- round(prop.table(table(factor(d$sci_c)))*100,2)
sci_c <- as.data.frame(sci_c)
sci_c$group <- substring(row.names(sci_c), 1)
sci_c$group <- revalue(as.character(sci_c$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_c$plot <- factor(sci_c$group, sci_c$group)
cols <- c(brewer.pal(5,"RdYlGn"))
p <- ggplot(sci_c, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = sci_c, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("I feel like a member of this neighbourhood")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_c.tb <- as.factor(d$sci_c)
sci_c.tb <- summary(sci_c.tb)
sci_c.tb <- as.data.frame(sci_c.tb)
sci_c.tb$Var1 <- substring(row.names(sci_c.tb), 1)
sci_c.tb$group <- revalue(as.character(sci_c.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_c.tb <- merge(sci_c, sci_c.tb, by = "group")
plot.sci_c.tb <- plot.sci_c.tb[-c(2, 4, 6)]
plot.sci_c.tb <- setcolorder(plot.sci_c.tb, c("group", "sci_c.tb", "Freq"))

plot.sci_c.tb$order <- c(3,4,2,5,1)
plot.sci_c.tb <- plot.sci_c.tb %>% arrange(order)
plot.sci_c.tb <- plot.sci_c.tb[-c(4)]
colnames(plot.sci_c.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_c.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### I belong in this neighbourhood
```{r}

#Plot sci_d
sci_d <- round(prop.table(table(factor(d$sci_d)))*100,2)
sci_d <- as.data.frame(sci_d)
sci_d$group <- substring(row.names(sci_d), 1)
sci_d$group <- revalue(as.character(sci_d$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_d$plot <- factor(sci_d$group, sci_d$group)
cols <- c(brewer.pal(5,"RdYlGn"))
p <- ggplot(sci_d, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = sci_d, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("I belong in this neighbourhood")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_d.tb <- as.factor(d$sci_d)
sci_d.tb <- summary(sci_d.tb)
sci_d.tb <- as.data.frame(sci_d.tb)
sci_d.tb$Var1 <- substring(row.names(sci_d.tb), 1)
sci_d.tb$group <- revalue(as.character(sci_d.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_d.tb <- merge(sci_d, sci_d.tb, by = "group")
plot.sci_d.tb <- plot.sci_d.tb[-c(2, 4, 6)]
plot.sci_d.tb <- setcolorder(plot.sci_d.tb, c("group", "sci_d.tb", "Freq"))

plot.sci_d.tb$order <- c(3,4,2,5,1)
plot.sci_d.tb <- plot.sci_d.tb %>% arrange(order)
plot.sci_d.tb <- plot.sci_d.tb[-c(4)]
colnames(plot.sci_d.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_d.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```
#### I have a say about what goes on in my neighbourhood
```{r}
#Plot sci_e
sci_e <- round(prop.table(table(factor(d$sci_e)))*100,2)
sci_e <- as.data.frame(sci_e)
sci_e$group <- substring(row.names(sci_e), 1)
sci_e$group <- revalue(as.character(sci_e$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_e$plot <- factor(sci_e$group, sci_e$group)
cols <- c(brewer.pal(5,"RdYlGn"))
p <- ggplot(sci_e, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = sci_e, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("I have a say about what goes on in my neighbourhood")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_e.tb <- as.factor(d$sci_e)
sci_e.tb <- summary(sci_e.tb)
sci_e.tb <- as.data.frame(sci_e.tb)
sci_e.tb$Var1 <- substring(row.names(sci_e.tb), 1)
sci_e.tb$group <- revalue(as.character(sci_e.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_e.tb <- merge(sci_e, sci_e.tb, by = "group")
plot.sci_e.tb <- plot.sci_e.tb[-c(2, 4, 6)]
plot.sci_e.tb <- setcolorder(plot.sci_e.tb, c("group", "sci_e.tb", "Freq"))

plot.sci_e.tb$order <- c(3,4,2,5,1)
plot.sci_e.tb <- plot.sci_e.tb %>% arrange(order)
plot.sci_e.tb <- plot.sci_e.tb[-c(4)]
colnames(plot.sci_e.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_e.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### People in this neighbourhood are good at influencing each other 
```{r}

#Plot sci_f
sci_f <- round(prop.table(table(factor(d$sci_f)))*100,2)
sci_f <- as.data.frame(sci_f)
sci_f$group <- substring(row.names(sci_f), 1)
sci_f$group <- revalue(as.character(sci_f$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_f$plot <- factor(sci_f$group, sci_f$group)

p <- ggplot(sci_f, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 
cols <- c(brewer.pal(5,"RdYlGn"))
p + geom_histogram(aes(x = plot), data = sci_f, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("People in this neighbourhood are good at influencing each other")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_f.tb <- as.factor(d$sci_f)
sci_f.tb <- summary(sci_f.tb)
sci_f.tb <- as.data.frame(sci_f.tb)
sci_f.tb$Var1 <- substring(row.names(sci_f.tb), 1)
sci_f.tb$group <- revalue(as.character(sci_f.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_f.tb <- merge(sci_f, sci_f.tb, by = "group")
plot.sci_f.tb <- plot.sci_f.tb[-c(2, 4, 6)]
plot.sci_f.tb <- setcolorder(plot.sci_f.tb, c("group", "sci_f.tb", "Freq"))

plot.sci_f.tb$order <- c(3,4,2,5,1)
plot.sci_f.tb <- plot.sci_f.tb %>% arrange(order)
plot.sci_f.tb <- plot.sci_f.tb[-c(4)]
colnames(plot.sci_f.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_f.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

#### I feel connected to this neighbourhood

```{r}

#Plot sci_g
sci_g <- round(prop.table(table(factor(d$sci_g)))*100,2)
sci_g <- as.data.frame(sci_g)
sci_g$group <- substring(row.names(sci_g), 1)
sci_g$group <- revalue(as.character(sci_g$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_g$plot <- factor(sci_g$group, sci_g$group)

p <- ggplot(sci_g, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 
cols <- c(brewer.pal(5,"RdYlGn"))
p + geom_histogram(aes(x = plot), data = sci_g, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("I feel connected to this neighbourhood")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_g.tb <- as.factor(d$sci_g)
sci_g.tb <- summary(sci_g.tb)
sci_g.tb <- as.data.frame(sci_g.tb)
sci_g.tb$Var1 <- substring(row.names(sci_g.tb), 1)
sci_g.tb$group <- revalue(as.character(sci_g.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_g.tb <- merge(sci_g, sci_g.tb, by = "group")
plot.sci_g.tb <- plot.sci_g.tb[-c(2, 4, 6)]
plot.sci_g.tb <- setcolorder(plot.sci_g.tb, c("group", "sci_g.tb", "Freq"))

plot.sci_g.tb$order <- c(3,4,2,5,1)
plot.sci_g.tb <- plot.sci_g.tb %>% arrange(order)
plot.sci_g.tb <- plot.sci_g.tb[-c(4)]
colnames(plot.sci_g.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_g.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

#### I have a good bond with others in this neighbourhood
```{r}

#Plot sci_h
sci_h <- round(prop.table(table(factor(d$sci_h)))*100,2)
sci_h <- as.data.frame(sci_h)
sci_h$group <- substring(row.names(sci_h), 1)
sci_h$group <- revalue(as.character(sci_h$group), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))
sci_h$plot <- factor(sci_h$group, sci_h$group)
cols <- c(brewer.pal(5,"RdYlGn"))
p <- ggplot(sci_h, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = sci_h, stat = "identity") +
  scale_fill_manual(values = cols)  +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("I have a good bond with others in this neighbourhood")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
sci_h.tb <- as.factor(d$sci_h)
sci_h.tb <- summary(sci_h.tb)
sci_h.tb <- as.data.frame(sci_h.tb)
sci_h.tb$Var1 <- substring(row.names(sci_h.tb), 1)
sci_h.tb$group <- revalue(as.character(sci_h.tb$Var1), c("1"="Strongly disagree", "2"="Somewhat disagree", "3"="Neither agree or disagree", "4"="Somewhat agree", "5"= "Strongly agree"))


## merge with existing prop table data used for plot above 
plot.sci_h.tb <- merge(sci_h, sci_h.tb, by = "group")
plot.sci_h.tb <- plot.sci_h.tb[-c(2, 4, 6)]
plot.sci_h.tb <- setcolorder(plot.sci_h.tb, c("group", "sci_h.tb", "Freq"))

plot.sci_h.tb$order <- c(3,4,2,5,1)
plot.sci_h.tb <- plot.sci_h.tb %>% arrange(order)
plot.sci_h.tb <- plot.sci_h.tb[-c(4)]
colnames(plot.sci_h.tb) <- c("Response", "N", "Percentage")

kable(plot.sci_h.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

## Section 6: Neighbourhood Perception

### In recent years, the urban environment of my neighbourhood has

```{r}
#change_urbenv

change_urbenv <- prop.table(table(factor(d$change_urbenv)))*100
change_urbenv <- as.data.frame(change_urbenv)
change_urbenv$group <- substring(row.names(change_urbenv), 1)
change_urbenv$group <- revalue(as.character(change_urbenv$group), c("1"="Gotten much better", "2"="Gotten a bit better", "3"="Stayed the same", "4"="Gotten a bit worse", "5"= "Gotten much worse"))
change_urbenv$plot <- factor(change_urbenv$group, change_urbenv$group)

p <- ggplot(change_urbenv, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 


p + geom_histogram(aes(x = plot), data = change_urbenv, stat = "identity") +
  scale_fill_brewer(palette = "RdYlGn", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("")

# make a clean summary table 
## make a dataframe on count 
change_urbenv.tb <- as.factor(d$change_urbenv)
change_urbenv.tb <- summary(change_urbenv.tb)
change_urbenv.tb <- as.data.frame(change_urbenv.tb)
change_urbenv.tb$Var1 <- substring(row.names(change_urbenv.tb), 1)
change_urbenv.tb$group <- revalue(as.character(change_urbenv.tb$Var1), c("1"="Gotten much better", "2"="Gotten a bit better", "3"="Stayed the same", "4"="Gotten a bit worse", "5"= "Gotten much worse"))


## merge with existing prop table data used for plot above 
plot.change_urbenv.tb <- merge(change_urbenv, change_urbenv.tb, by = "group")
plot.change_urbenv.tb <- plot.change_urbenv.tb[-c(2, 4, 6)]
plot.change_urbenv.tb <- setcolorder(plot.change_urbenv.tb, c("group", "change_urbenv.tb", "Freq"))

plot.change_urbenv.tb$order <- c(2,4,1,5,3)
plot.change_urbenv.tb <- plot.change_urbenv.tb %>% arrange(order)
plot.change_urbenv.tb <- plot.change_urbenv.tb[-c(4)]
colnames(plot.change_urbenv.tb) <- c("Response", "N", "Percentage")

kable(plot.change_urbenv.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```
### To what extent do you agree or disagree with these statements. In my neighbourhood.

```{r}

## POSITIVE ITEMS 

# Subset urban features from Health data
feat_urbenv_pos <- Health[,c("feat_urbenv_b", "feat_urbenv_d", "feat_urbenv_f", "feat_urbenv_g", "feat_urbenv_h", "feat_urbenv_j", 
                      "feat_urbenv_l", "feat_urbenv_m", "feat_urbenv_o")]


# Rename columns
colnames(feat_urbenv_pos) <- c( "Car traffic moves fluidly and efficiently", 
                            "The sidewalks are in good condition", 
                            "There are enough trees along the street", 
                            "There are many public spaces where people can relax and socialize (placottoirs, parks, plazas, street seating, etc.)", 
                            "Shops and services are easily accessible", 
                            "There are sufficient public transit options nearby", 
                            "There are many parks nearby", 
                            "There are lots of greened spaces", 
                            "There is a connected network of bike paths") 


# Change columns to factor
feat_urbenv_pos[] <- lapply(feat_urbenv_pos, factor)

##Create question names for plot display
items <- likert(feat_urbenv_pos)

##realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "blue",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)


## NEGATIVE ITEMS 
# Subset urban features from Health data
feat_urbenv_neg <- Health[,c("feat_urbenv_a", "feat_urbenv_c", "feat_urbenv_e", "feat_urbenv_i", 
                       "feat_urbenv_k", "feat_urbenv_n")]


# Rename columns
colnames(feat_urbenv_neg) <- c("Parking is difficult in local shopping areas", 
                               "Streets can be excessively noisy", 
                               "The sidewalks are not wide enough", 
                               "There are no urban furnishings like benches or bike parking", 
                               "The air is polluted", 
                               "It is especially dangerous to bike on the street") 


# Change columns to factor
feat_urbenv_neg[] <- lapply(feat_urbenv_neg, factor)

##Create question names for plot display
items <- likert(feat_urbenv_neg)

##realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "red",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)


```

### To what extent do you agree or disagree with the following statements? In my neighbourhood, there are more and more.


```{r}
#increase_urbenv_a

increase_urbenv <- d %>% select(increase_urbenv_a, increase_urbenv_b, increase_urbenv_c, increase_urbenv_d, increase_urbenv_e, increase_urbenv_f, increase_urbenv_g)
increase_urbenv$increase_urbenv_a <- revalue(as.factor(increase_urbenv$increase_urbenv_a), c("1" = "Completely agree", "4" = "Completely disagree"))
increase_urbenv$increase_urbenv_b <- revalue(as.factor(increase_urbenv$increase_urbenv_b), c("1" = "Completely agree", "4" = "Completely disagree"))
increase_urbenv$increase_urbenv_c <- revalue(as.factor(increase_urbenv$increase_urbenv_c), c("1" = "Completely agree", "4" = "Completely disagree"))
increase_urbenv$increase_urbenv_d <- revalue(as.factor(increase_urbenv$increase_urbenv_d), c("1" = "Completely agree", "4" = "Completely disagree"))
increase_urbenv$increase_urbenv_e <- revalue(as.factor(increase_urbenv$increase_urbenv_e), c("1" = "Completely agree", "4" = "Completely disagree"))
increase_urbenv$increase_urbenv_f <- revalue(as.factor(increase_urbenv$increase_urbenv_f), c("1" = "Completely agree", "4" = "Completely disagree"))
increase_urbenv$increase_urbenv_g <- revalue(as.factor(increase_urbenv$increase_urbenv_g), c("1" = "Completely agree", "4" = "Completely disagree"))

##Create question names for plot display
names(increase_urbenv) <- c("a. Bike paths", "b. Pedestrian-friendly designs, like wider sidewalks, speed-bumps, and stop signs", "c. Potholes", "d. Green alleys (ruelles vertes)", "e. Greened spaces featuring trees, gardens, and planters", "f. Graffiti", "g. Pedestrianized streets") 
items <- likert(increase_urbenv)

##realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "green",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)



```

### To what extent do you agree or disagree with the following statements?
a. The City is investing in my neighbourhood.
b. The changes in my neighbourhood are improving my quality of life.
c. My neighbourhood is more and more dynamic.
d. Low-income people can't afford to stay in this neighbourhood.
e. I feel more and more anonymous in my neighbourhood


```{r}

#changeeffects_urbenv


changeeffects_urbenv <- d %>% select(changeeffects_urbenv_a, changeeffects_urbenv_b, changeeffects_urbenv_c, changeeffects_urbenv_d, changeeffects_urbenv_e)
changeeffects_urbenv$changeeffects_urbenv_a <- revalue(as.factor(changeeffects_urbenv$changeeffects_urbenv_a), 
                                                       c("1" = "Completely agree", "4" = "Completely disagree"))
changeeffects_urbenv$changeeffects_urbenv_b <- revalue(as.factor(changeeffects_urbenv$changeeffects_urbenv_b), 
                                                       c("1" = "Completely agree", "4" = "Completely disagree"))
changeeffects_urbenv$changeeffects_urbenv_c <- revalue(as.factor(changeeffects_urbenv$changeeffects_urbenv_c), 
                                                       c("1" = "Completely agree", "4" = "Completely disagree"))
changeeffects_urbenv$changeeffects_urbenv_d <- revalue(as.factor(changeeffects_urbenv$changeeffects_urbenv_d), 
                                                       c("1" = "Completely agree", "4" = "Completely disagree"))
changeeffects_urbenv$changeeffects_urbenv_e <- revalue(as.factor(changeeffects_urbenv$changeeffects_urbenv_e), 
                                                       c("1" = "Completely agree", "4" = "Completely disagree"))

##Create question names for plot display
names(changeeffects_urbenv) <- c("a. The City is investing in my neighbourhood", 
                                 "b. The changes in my neighbourhood are improving my quality of life", 
                                 "c. My neighbourhood is more and more dynamic", 
                                 "d. Low-income people can't afford to stay in this neighbourhood", 
                                 "e. I feel more and more anonymous in my neighbourhood") 
items <- likert(changeeffects_urbenv)

##realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "red",
                 text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)



```



### To what extent do you agree or disagree with the following statements? The changes in my neighbourhood are making it easier for me to get around:
a. By foot
b. By bike
c. By car
d. By transit


```{r}

#changeeffects_urbenv_trans
d$changeeffects_urbenv_trans_a[d$changeeffects_urbenv_trans_a==-7] <- NA
d$changeeffects_urbenv_trans_b[d$changeeffects_urbenv_trans_b==-7] <- NA
d$changeeffects_urbenv_trans_c[d$changeeffects_urbenv_trans_c==-7] <- NA
d$changeeffects_urbenv_trans_d[d$changeeffects_urbenv_trans_d==-7] <- NA

changeeffects_urbenv_trans <- d %>% select(changeeffects_urbenv_trans_a, changeeffects_urbenv_trans_b, changeeffects_urbenv_trans_c, changeeffects_urbenv_trans_d)
changeeffects_urbenv_trans$changeeffects_urbenv_trans_a <- revalue(as.factor(changeeffects_urbenv_trans$changeeffects_urbenv_trans_a), c("1" = "Completely agree", "4" = "Completely disagree"))
changeeffects_urbenv_trans$changeeffects_urbenv_trans_b <- revalue(as.factor(changeeffects_urbenv_trans$changeeffects_urbenv_trans_b), c("1" = "Completely agree", "4" = "Completely disagree"))
changeeffects_urbenv_trans$changeeffects_urbenv_trans_c <- revalue(as.factor(changeeffects_urbenv_trans$changeeffects_urbenv_trans_c), c("1" = "Completely agree", "4" = "Completely disagree"))
changeeffects_urbenv_trans$changeeffects_urbenv_trans_d <- revalue(as.factor(changeeffects_urbenv_trans$changeeffects_urbenv_trans_d), c("1" = "Completely agree", "4" = "Completely disagree"))

##Create question names for plot display
names(changeeffects_urbenv_trans) <- c("a. By foot", "b. By bike", "c. By car", "d. By transit")
items <- likert(changeeffects_urbenv_trans)

##realize a heat plot of question responses
likert.heat.plot(items, low.color = "white", high.color = "blue", text.color = "black", text.size = 5, wrap = 70, wrap.grouping = 100, plot.percent=FALSE)

```

## Section 7: Neighbourhood Selection

### Before moving into your current dwelling, when you were looking for a neighbourhood to live in, to what extent were the following characteristics important? Please report your perspectives, even if the neighbourhood where you currently live does not have these characteristics {.tabset}

#### a. Good access to public transportation

```{r}
#neigh_pref_a

neigh_pref_a <- round(prop.table(table(factor(d$neigh_pref_a)))*100,2)
neigh_pref_a <- as.data.frame(neigh_pref_a)
neigh_pref_a$group <- substring(row.names(neigh_pref_a), 1)
neigh_pref_a$group <- revalue(as.character(neigh_pref_a$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_a$plot <- factor(neigh_pref_a$group, neigh_pref_a$group)

p <- ggplot(neigh_pref_a, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_a, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("a. Good access to public transportation")+ 
  theme(plot.title = element_text(size=16))


# make a clean summary table 
## make a dataframe on count 
neigh_pref_a.tb <- as.factor(d$neigh_pref_a)
neigh_pref_a.tb <- summary(neigh_pref_a.tb)
neigh_pref_a.tb <- as.data.frame(neigh_pref_a.tb)
neigh_pref_a.tb$Var1 <- substring(row.names(neigh_pref_a.tb), 1)
neigh_pref_a.tb$group <- revalue(as.character(neigh_pref_a.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_a.tb <- merge(neigh_pref_a, neigh_pref_a.tb, by = "group")
plot.neigh_pref_a.tb <- plot.neigh_pref_a.tb[-c(2, 4, 6)]
plot.neigh_pref_a.tb <- setcolorder(plot.neigh_pref_a.tb, c("group", "neigh_pref_a.tb", "Freq"))

plot.neigh_pref_a.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_a.tb <- plot.neigh_pref_a.tb %>% arrange(order)
plot.neigh_pref_a.tb <- plot.neigh_pref_a.tb[-c(4)]
colnames(plot.neigh_pref_a.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### b. Sufficient parks and green spaces

```{r}

#neigh_pref_b

neigh_pref_b <- round(prop.table(table(factor(d$neigh_pref_b)))*100,2)
neigh_pref_b <- as.data.frame(neigh_pref_b)
neigh_pref_b$group <- substring(row.names(neigh_pref_b), 1)
neigh_pref_b$group <- revalue(as.character(neigh_pref_b$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_b$plot <- factor(neigh_pref_b$group, neigh_pref_b$group)

p <- ggplot(neigh_pref_b, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_b, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("b. Sufficient parks and green spaces")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_b.tb <- as.factor(d$neigh_pref_b)
neigh_pref_b.tb <- summary(neigh_pref_b.tb)
neigh_pref_b.tb <- as.data.frame(neigh_pref_b.tb)
neigh_pref_b.tb$Var1 <- substring(row.names(neigh_pref_b.tb), 1)
neigh_pref_b.tb$group <- revalue(as.character(neigh_pref_b.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_b.tb <- merge(neigh_pref_b, neigh_pref_b.tb, by = "group")
plot.neigh_pref_b.tb <- plot.neigh_pref_b.tb[-c(2, 4, 6)]
plot.neigh_pref_b.tb <- setcolorder(plot.neigh_pref_b.tb, c("group", "neigh_pref_b.tb", "Freq"))

plot.neigh_pref_b.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_b.tb <- plot.neigh_pref_b.tb %>% arrange(order)
plot.neigh_pref_b.tb <- plot.neigh_pref_b.tb[-c(4)]
colnames(plot.neigh_pref_b.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```
#### c. Sufficient shops and services
```{r}

#neigh_pref_c

neigh_pref_c <- round(prop.table(table(factor(d$neigh_pref_c)))*100,2)
neigh_pref_c <- as.data.frame(neigh_pref_c)
neigh_pref_c$group <- substring(row.names(neigh_pref_c), 1)
neigh_pref_c$group <- revalue(as.character(neigh_pref_c$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_c$plot <- factor(neigh_pref_c$group, neigh_pref_c$group)

p <- ggplot(neigh_pref_c, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_c, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("c. Sufficient shops and services")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_c.tb <- as.factor(d$neigh_pref_c)
neigh_pref_c.tb <- summary(neigh_pref_c.tb)
neigh_pref_c.tb <- as.data.frame(neigh_pref_c.tb)
neigh_pref_c.tb$Var1 <- substring(row.names(neigh_pref_c.tb), 1)
neigh_pref_c.tb$group <- revalue(as.character(neigh_pref_c.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_c.tb <- merge(neigh_pref_c, neigh_pref_c.tb, by = "group")
plot.neigh_pref_c.tb <- plot.neigh_pref_c.tb[-c(2, 4, 6)]
plot.neigh_pref_c.tb <- setcolorder(plot.neigh_pref_c.tb, c("group", "neigh_pref_c.tb", "Freq"))

plot.neigh_pref_c.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_c.tb <- plot.neigh_pref_c.tb %>% arrange(order)
plot.neigh_pref_c.tb <- plot.neigh_pref_c.tb[-c(4)]
colnames(plot.neigh_pref_c.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_c.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### d. Proximity to doctors, a pharmacy or other health services
```{r}

#neigh_pref_d

neigh_pref_d <- round(prop.table(table(factor(d$neigh_pref_d)))*100,2)
neigh_pref_d <- as.data.frame(neigh_pref_d)
neigh_pref_d$group <- substring(row.names(neigh_pref_d), 1)
neigh_pref_d$group <- revalue(as.character(neigh_pref_d$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_d$plot <- factor(neigh_pref_d$group, neigh_pref_d$group)

p <- ggplot(neigh_pref_d, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_d, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("d. Proximity to doctors, a pharmacy or other health services")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_d.tb <- as.factor(d$neigh_pref_d)
neigh_pref_d.tb <- summary(neigh_pref_d.tb)
neigh_pref_d.tb <- as.data.frame(neigh_pref_d.tb)
neigh_pref_d.tb$Var1 <- substring(row.names(neigh_pref_d.tb), 1)
neigh_pref_d.tb$group <- revalue(as.character(neigh_pref_d.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_d.tb <- merge(neigh_pref_d, neigh_pref_d.tb, by = "group")
plot.neigh_pref_d.tb <- plot.neigh_pref_d.tb[-c(2, 4, 6)]
plot.neigh_pref_d.tb <- setcolorder(plot.neigh_pref_d.tb, c("group", "neigh_pref_d.tb", "Freq"))

plot.neigh_pref_d.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_d.tb <- plot.neigh_pref_d.tb %>% arrange(order)
plot.neigh_pref_d.tb <- plot.neigh_pref_d.tb[-c(4)]
colnames(plot.neigh_pref_d.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_d.tb)%>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### e. A good knowledge of the neighbourhood
```{r}

#neigh_pref_e

neigh_pref_e <- round(prop.table(table(factor(d$neigh_pref_e)))*100,2)
neigh_pref_e <- as.data.frame(neigh_pref_e)
neigh_pref_e$group <- substring(row.names(neigh_pref_e), 1)
neigh_pref_e$group <- revalue(as.character(neigh_pref_e$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_e$plot <- factor(neigh_pref_e$group, neigh_pref_e$group)

p <- ggplot(neigh_pref_e, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_e, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("e. A good knowledge of the neighbourhood")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_e.tb <- as.factor(d$neigh_pref_e)
neigh_pref_e.tb <- summary(neigh_pref_e.tb)
neigh_pref_e.tb <- as.data.frame(neigh_pref_e.tb)
neigh_pref_e.tb$Var1 <- substring(row.names(neigh_pref_e.tb), 1)
neigh_pref_e.tb$group <- revalue(as.character(neigh_pref_e.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_e.tb <- merge(neigh_pref_e, neigh_pref_e.tb, by = "group")
plot.neigh_pref_e.tb <- plot.neigh_pref_e.tb[-c(2, 4, 6)]
plot.neigh_pref_e.tb <- setcolorder(plot.neigh_pref_e.tb, c("group", "neigh_pref_e.tb", "Freq"))

plot.neigh_pref_e.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_e.tb <- plot.neigh_pref_e.tb %>% arrange(order)
plot.neigh_pref_e.tb <- plot.neigh_pref_e.tb[-c(4)]
colnames(plot.neigh_pref_e.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_e.tb)%>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### f. Presence of relatives, friends or acquaintances
```{r}

#neigh_pref_f

neigh_pref_f <- round(prop.table(table(factor(d$neigh_pref_f)))*100,2)
neigh_pref_f <- as.data.frame(neigh_pref_f)
neigh_pref_f$group <- substring(row.names(neigh_pref_f), 1)
neigh_pref_f$group <- revalue(as.character(neigh_pref_f$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_f$plot <- factor(neigh_pref_f$group, neigh_pref_f$group)

p <- ggplot(neigh_pref_f, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_f, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("f. Presence of relatives, friends or acquaintances")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_f.tb <- as.factor(d$neigh_pref_f)
neigh_pref_f.tb <- summary(neigh_pref_f.tb)
neigh_pref_f.tb <- as.data.frame(neigh_pref_f.tb)
neigh_pref_f.tb$Var1 <- substring(row.names(neigh_pref_f.tb), 1)
neigh_pref_f.tb$group <- revalue(as.character(neigh_pref_f.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_f.tb <- merge(neigh_pref_f, neigh_pref_f.tb, by = "group")
plot.neigh_pref_f.tb <- plot.neigh_pref_f.tb[-c(2, 4, 6)]
plot.neigh_pref_f.tb <- setcolorder(plot.neigh_pref_f.tb, c("group", "neigh_pref_f.tb", "Freq"))

plot.neigh_pref_f.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_f.tb <- plot.neigh_pref_f.tb %>% arrange(order)
plot.neigh_pref_f.tb <- plot.neigh_pref_f.tb[-c(4)]
colnames(plot.neigh_pref_f.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_f.tb)%>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```
#### g. A neighbourhood where it is pleasant to walk
```{r}

#neigh_pref_g

neigh_pref_g <- round(prop.table(table(factor(d$neigh_pref_g)))*100,2)
neigh_pref_g <- as.data.frame(neigh_pref_g)
neigh_pref_g$group <- substring(row.names(neigh_pref_g), 1)
neigh_pref_g$group <- revalue(as.character(neigh_pref_g$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_g$plot <- factor(neigh_pref_g$group, neigh_pref_g$group)

p <- ggplot(neigh_pref_g, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_g, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("g. A neighbourhood where it is pleasant to walk")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_g.tb <- as.factor(d$neigh_pref_g)
neigh_pref_g.tb <- summary(neigh_pref_g.tb)
neigh_pref_g.tb <- as.data.frame(neigh_pref_g.tb)
neigh_pref_g.tb$Var1 <- substring(row.names(neigh_pref_g.tb), 1)
neigh_pref_g.tb$group <- revalue(as.character(neigh_pref_g.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_g.tb <- merge(neigh_pref_g, neigh_pref_g.tb, by = "group")
plot.neigh_pref_g.tb <- plot.neigh_pref_g.tb[-c(2, 4, 6)]
plot.neigh_pref_g.tb <- setcolorder(plot.neigh_pref_g.tb, c("group", "neigh_pref_g.tb", "Freq"))

plot.neigh_pref_g.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_g.tb <- plot.neigh_pref_g.tb %>% arrange(order)
plot.neigh_pref_g.tb <- plot.neigh_pref_g.tb[-c(4)]
colnames(plot.neigh_pref_g.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_g.tb)%>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```


#### h. A neighbourhood where it is practical to move around by car (ease of parking, low traffic, good access by car)
```{r}

#neigh_pref_h

neigh_pref_h <- round(prop.table(table(factor(d$neigh_pref_h)))*100,2)
neigh_pref_h <- as.data.frame(neigh_pref_h)
neigh_pref_h$group <- substring(row.names(neigh_pref_h), 1)
neigh_pref_h$group <- revalue(as.character(neigh_pref_h$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_h$plot <- factor(neigh_pref_h$group, neigh_pref_h$group)

p <- ggplot(neigh_pref_h, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_h, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("h. A neighbourhood where it is practical to move around by car (ease of parking, low traffic, good access by car")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_h.tb <- as.factor(d$neigh_pref_h)
neigh_pref_h.tb <- summary(neigh_pref_h.tb)
neigh_pref_h.tb <- as.data.frame(neigh_pref_h.tb)
neigh_pref_h.tb$Var1 <- substring(row.names(neigh_pref_h.tb), 1)
neigh_pref_h.tb$group <- revalue(as.character(neigh_pref_h.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_h.tb <- merge(neigh_pref_h, neigh_pref_h.tb, by = "group")
plot.neigh_pref_h.tb <- plot.neigh_pref_h.tb[-c(2, 4, 6)]
plot.neigh_pref_h.tb <- setcolorder(plot.neigh_pref_h.tb, c("group", "neigh_pref_h.tb", "Freq"))

plot.neigh_pref_h.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_h.tb <- plot.neigh_pref_h.tb %>% arrange(order)
plot.neigh_pref_h.tb <- plot.neigh_pref_h.tb[-c(4)]
colnames(plot.neigh_pref_h.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_h.tb)%>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

#### i. Presence of good schools
```{r}

#neigh_pref_i

neigh_pref_i <- round(prop.table(table(factor(d$neigh_pref_i)))*100,2)
neigh_pref_i <- as.data.frame(neigh_pref_i)
neigh_pref_i$group <- substring(row.names(neigh_pref_i), 1)
neigh_pref_i$group <- revalue(as.character(neigh_pref_i$group), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "5" = "I don't know"))
neigh_pref_i$plot <- factor(neigh_pref_i$group, neigh_pref_i$group)

p <- ggplot(neigh_pref_i, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

p + geom_histogram(aes(x = plot), data = neigh_pref_i, stat = "identity") +
  scale_fill_brewer(palette = "Blues", direction=-1) +
  guides(fill=FALSE)+
  ylab("Percent of total") +
  xlab("") +
  ggtitle("i. Presence of good schools")+ 
  theme(plot.title = element_text(size=16))

# make a clean summary table 
## make a dataframe on count 
neigh_pref_i.tb <- as.factor(d$neigh_pref_i)
neigh_pref_i.tb <- summary(neigh_pref_i.tb)
neigh_pref_i.tb <- as.data.frame(neigh_pref_i.tb)
neigh_pref_i.tb$Var1 <- substring(row.names(neigh_pref_i.tb), 1)
neigh_pref_i.tb$group <- revalue(as.character(neigh_pref_i.tb$Var1), c("1" = "Very important", "2" = "Somewhat important", "3" = "Not very important", "4" = "Not important at all", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.neigh_pref_i.tb <- merge(neigh_pref_i, neigh_pref_i.tb, by = "group")
plot.neigh_pref_i.tb <- plot.neigh_pref_i.tb[-c(2, 4, 6)]
plot.neigh_pref_i.tb <- setcolorder(plot.neigh_pref_i.tb, c("group", "neigh_pref_i.tb", "Freq"))

plot.neigh_pref_i.tb$order <- c(5,4,3,2,1)
plot.neigh_pref_i.tb <- plot.neigh_pref_i.tb %>% arrange(order)
plot.neigh_pref_i.tb <- plot.neigh_pref_i.tb[-c(4)]
colnames(plot.neigh_pref_i.tb) <- c("Response", "N", "Percentage")

kable(plot.neigh_pref_i.tb)%>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

## Section 8: Activity Tracking 

### Do you currently own or use any of the following devices or smartphone apps to monitor your physical activity? {.tabset} 

#### No

```{r}
#tracking1 and tracking1_use


tracking1_no <- round((sum(d$tracking1_no)/ length(d$tracking1_no))*100,2)

tracking1_no_interest <- round((sum(d$tracking1_no_interest)/ length(d$tracking1_no_interest))*100,2)

no_tracking <- data.frame(Response=c("I do not have one but might be interested in trying one", "I do not have one and I am not interested in trying one"),
                          Percentage= c(tracking1_no, tracking1_no_interest))

kable(no_tracking) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  

```

#### Own

```{r}

#tracking own 

# Create a vector with variable names
response = paste0("tracking1_own_", 1:4)

# Empty vector to stor output
tracking1_own_prop <- c()

# Calculate univariate proportions
for(i in response){
  tracking1_own_prop[i] <- sum(d[,i]) / nrow(d)
}

# Transform
tracking1_own_prop <- as.data.frame(tracking1_own_prop)
tracking1_own_prop$Own <- c("Wearable devices (Fitbits, Garmins, and Jawbone, etc.)","Smart watches (Apple Watch, Galaxy Gear, Samsung Gear, etc.)","Smartphone app (Apple Health, Samsung Health, Google Fit, Strava, etc.)","Other")

tracking1_own_prop$plot<- factor(tracking1_own_prop$Own, tracking1_own_prop$Own)

ggplot(tracking1_own_prop, aes(x = plot, y = tracking1_own_prop)) + geom_bar(stat = "identity", fill = "#76D24A") + xlab("") + ylab("Percent of participants who selected this answer") + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10))

tracking1_own_prop <- tracking1_own_prop[-c(3)]
tracking1_own_prop$tracking1_own_prop <- round(tracking1_own_prop$tracking1_own_prop*100,2)

tracking1_own_prop <- setcolorder(tracking1_own_prop, c("Own", "tracking1_own_prop"))

colnames(tracking1_own_prop) <- c("Response", "Percent of participants who selected this answer")

kable(tracking1_own_prop) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  
```

#### Use


```{r}

#tracking use

# Create a vector with variable names
response = paste0("tracking1_use_", 1:4)

# Empty vector to stor output
tracking1_use_prop <- c()

# Calculate univariate proportions
for(i in response){
  tracking1_use_prop[i] <- sum(d[,i]) / nrow(d)
}

# Transform
tracking1_use_prop <- as.data.frame(tracking1_use_prop)
tracking1_use_prop$use <- c("Wearable devices (Fitbits, Garmins, and Jawbone, etc.)","Smart watches (Apple Watch, Galaxy Gear, Samsung Gear, etc.)","Smartphone app (Apple Health, Samsung Health, Google Fit, Strava, etc.)","Other")

tracking1_use_prop$plot<- factor(tracking1_use_prop$use, tracking1_use_prop$use)

ggplot(tracking1_use_prop, aes(x = plot, y = tracking1_use_prop)) + geom_bar(stat = "identity", fill = "#76D24A") + xlab("") + ylab("Percent of participants who selected this answer") + theme(axis.text.x  = element_text(angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10))

tracking1_use_prop <- tracking1_use_prop[-c(3)]
tracking1_use_prop$tracking1_use_prop <- round(tracking1_use_prop$tracking1_use_prop*100,2)

tracking1_use_prop <- setcolorder(tracking1_use_prop, c("use", "tracking1_use_prop"))

colnames(tracking1_use_prop) <- c("Response", "Percent of participants who selected this answer")

kable(tracking1_use_prop) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  

```


### Thinking about a typical month, how many days on average do you use your device or smartphone app to monitor your physical activity? If you own several activity trackers, choose the one that you use most often.

```{r}
#tracking2

d$tracking2[d$tracking2==-7] <- NA

ggplot(d, aes(d$tracking2)) + geom_histogram(na.rm = TRUE, binwidth = 1, fill="#76D24A") + xlab("Days per month") 

```

### When using a device or app to monitor your physical activity, how concerned are you about the possibility of your location being known by the company which developed the device or app?


```{r}
#tracking3a
d$tracking3a[d$tracking3a==-7] <- NA

tracking3a <- round(prop.table(table(factor(d$tracking3a)))*100,2)
tracking3a <- as.data.frame(tracking3a)
tracking3a$group <- substring(row.names(tracking3a), 1)
tracking3a$group <- revalue(as.character(tracking3a$group), c("1" = "Not at all", "2" = "Slightly", "3" = "Moderately", "4" = "Very much", "5" = "Extremely", "6"= "I have no opinion on the subject"))
tracking3a$plot <- factor(tracking3a$group, tracking3a$group)

p <- ggplot(tracking3a, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

cols <- c(brewer.pal(5,"Blues"),"grey")

p + geom_histogram(aes(x = plot), data = tracking3a, stat = "identity") + 
  scale_fill_manual(values=cols)+
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("")

# make a clean summary table 
## make a dataframe on count 
tracking3a.tb <- as.factor(d$tracking3a)
tracking3a.tb <- summary(tracking3a.tb)
tracking3a.tb <- as.data.frame(tracking3a.tb)
tracking3a.tb$Var1 <- substring(row.names(tracking3a.tb), 1)
tracking3a.tb$group <- revalue(as.character(tracking3a.tb$Var1), c("1" = "Not at all", "2" = "Slightly", "3" = "Moderately", "4" = "Very much", "5" = "Extremely", "6"= "I have no opinion on the subject"))


## merge with existing prop table data used for plot above 
plot.tracking3a.tb <- merge(tracking3a, tracking3a.tb, by = "group")
plot.tracking3a.tb <- plot.tracking3a.tb[-c(2, 4, 6)]
plot.tracking3a.tb <- setcolorder(plot.tracking3a.tb, c("group", "tracking3a.tb", "Freq"))

plot.tracking3a.tb$order <- c(5,6,3,1,2,4)
plot.tracking3a.tb <- plot.tracking3a.tb %>% arrange(order)
plot.tracking3a.tb <- plot.tracking3a.tb[-c(4)]
colnames(plot.tracking3a.tb) <- c("Response", "N", "Percentage")

kable(plot.tracking3a.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
```

### If you had to use a device or app, how concerned would you be about the possibility of your location being known by the company which developed the device or app?


```{r}

#tracking3b  
d$tracking3b[d$tracking3b==-7] <- NA

tracking3b <- round(prop.table(table(factor(d$tracking3b)))*100,2)
tracking3b <- as.data.frame(tracking3b)
tracking3b$group <- substring(row.names(tracking3b), 1)
tracking3b$group <- revalue(as.character(tracking3b$group), c("1" = "Not at all", "2" = "Slightly", "3" = "Moderately", "4" = "Very much", "5" = "Extremely", "6"= "I have no opinion on the subject"))
tracking3b$plot <- factor(tracking3b$group, tracking3b$group)

p <- ggplot(tracking3b, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 
cols <- c(brewer.pal(5,"Blues"),"grey")

p + geom_histogram(aes(x = plot), data = tracking3b, stat = "identity") +
  scale_fill_manual(values = cols) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("")


# make a clean summary table 
## make a dataframe on count 
tracking3b.tb <- as.factor(d$tracking3b)
tracking3b.tb <- summary(tracking3b.tb)
tracking3b.tb <- as.data.frame(tracking3b.tb)
tracking3b.tb$Var1 <- substring(row.names(tracking3b.tb), 1)
tracking3b.tb$group <- revalue(as.character(tracking3b.tb$Var1), c("1" = "Not at all", "2" = "Slightly", "3" = "Moderately", "4" = "Very much", "5" = "Extremely", "6"= "I have no opinion on the subject"))


## merge with existing prop table data used for plot above 
plot.tracking3b.tb <- merge(tracking3b, tracking3b.tb, by = "group")
plot.tracking3b.tb <- plot.tracking3b.tb[-c(2, 4, 6)]
plot.tracking3b.tb <- setcolorder(plot.tracking3b.tb, c("group", "tracking3b.tb", "Freq"))

plot.tracking3b.tb$order <- c(5,6,3,1,2,4)
plot.tracking3b.tb <- plot.tracking3b.tb %>% arrange(order)
plot.tracking3b.tb <- plot.tracking3b.tb[-c(4)]
colnames(plot.tracking3b.tb) <- c("Response", "N", "Percentage")

kable(plot.tracking3b.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")
  
```

### How concerned are you about the possibility of your location being known by your network mobile provider when using a smartphone?
 
```{r}
#tracking4
 
d$tracking4[d$tracking4==-7] <- NA

tracking4 <- round(prop.table(table(factor(d$tracking4)))*100,2)
tracking4 <- as.data.frame(tracking4)
tracking4$group <- substring(row.names(tracking4), 1)
tracking4$group <- revalue(as.character(tracking4$group), c("1" = "Not at all", "2" = "Slightly", "3" = "Moderately", "4" = "Very much", "5" = "Extremely", "6"= "No opinion", "7" = "I do not use a smartphone"))
tracking4$plot <- factor(tracking4$group, tracking4$group)

p <- ggplot(tracking4, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 
cols <- c(brewer.pal(5,"Blues"),"grey", "grey")

p + geom_histogram(aes(x = plot), data = tracking4, stat = "identity") +
  scale_fill_manual(values = cols) +
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("")

# make a clean summary table 
## make a dataframe on count 
tracking4.tb <- as.factor(d$tracking4)
tracking4.tb <- summary(tracking4.tb)
tracking4.tb <- as.data.frame(tracking4.tb)
tracking4.tb$Var1 <- substring(row.names(tracking4.tb), 1)
tracking4.tb$group <- revalue(as.character(tracking4.tb$Var1), c("1" = "Not at all", "2" = "Slightly", "3" = "Moderately", "4" = "Very much", "5" = "Extremely", "6"= "No opinion", "7" = "I do not use a smartphone"))


## merge with existing prop table data used for plot above 
plot.tracking4.tb <- merge(tracking4, tracking4.tb, by = "group")
plot.tracking4.tb <- plot.tracking4.tb[-c(2, 4, 6)]
plot.tracking4.tb <- setcolorder(plot.tracking4.tb, c("group", "tracking4.tb", "Freq"))

plot.tracking4.tb$order <- c(5,6,3,7,1,2,4)
plot.tracking4.tb <- plot.tracking4.tb %>% arrange(order)
plot.tracking4.tb <- plot.tracking4.tb[-c(4)]
colnames(plot.tracking4.tb) <- c("Response", "N", "Percentage")

kable(plot.tracking4.tb) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 
```


### Compared with friends of my age, my concern regarding protecting my privacy is.
```{r}
#tracking5
d$tracking5[d$tracking5==-7] <- NA

tracking5 <- round(prop.table(table(factor(d$tracking5)))*100,2)
tracking5 <- as.data.frame(tracking5)
tracking5$group <- substring(row.names(tracking5), 1)
tracking5$group <- revalue(as.character(tracking5$group), c("1" = "Much lower", "2" = "Lower", "3" = "About the same", "4" = "Higher", "5" = "Much higher"))
tracking5$plot <- factor(tracking5$group, tracking5$group)

p <- ggplot(tracking5, aes(x=group, y=Freq, fill=plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 
cols <- c(brewer.pal(5,"Blues"))

p + geom_histogram(aes(x = plot), data = tracking5, stat = "identity") +
  scale_fill_manual(values=cols) + 
  guides(fill=FALSE)+
      ylab("Percent of total") +
      xlab("")

tracking5.tb <- as.factor(d$tracking5)
tracking5.tb <- summary(tracking5.tb)
tracking5.tb <- as.data.frame(tracking5.tb)
tracking5.tb$Var1 <- substring(row.names(tracking5.tb), 1)
tracking5.tb$group <- revalue(as.character(tracking5.tb$Var1), c("1" = "Much lower", "2" = "Lower", "3" = "About the same", "4" = "Higher", "5" = "Much higher"))


## merge with existing prop table data used for plot above 
plot.tracking5.tb <- merge(tracking5, tracking5.tb, by = "group")
plot.tracking5.tb <- plot.tracking5.tb[-c(2, 4, 6)]
plot.tracking5.tb <- setcolorder(plot.tracking5.tb, c("group", "tracking5.tb", "Freq"))

plot.tracking5.tb$order <- c(3,4,2,5,1)
plot.tracking5.tb <- plot.tracking5.tb %>% arrange(order)
plot.tracking5.tb <- plot.tracking5.tb[-c(4)]
colnames(plot.tracking5.tb) <- c("Response", "N", "Percentage")

kable(plot.tracking5.tb) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   
```
## *Section 9: Demographics*

### Thinking about where you live now, are you 

```{r}
#house_tenure

house_tenure <- round(prop.table(table(factor(d$house_tenure)))*100,2)
house_tenure <- as.data.frame(house_tenure)
house_tenure$group <- substring(row.names(house_tenure), 1)
house_tenure$group <- revalue(as.character(house_tenure$group), c("1" = "An owner", "2" = "A tenant", "3" = "Resident in a relative or friend's home", "4" = "Resident other than in a relative or friend's home", "5" = "Other", "6" = "I don't know"))

house_tenure$plot <- factor(house_tenure$group, house_tenure$group)

house_tenure.plot <- ggplot(house_tenure, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = INTERACTPaletteSet) +
      ylab("Percent of total") +
      xlab("")
      
house_tenure.plot + geom_histogram(aes(x = plot), data = house_tenure, stat = "identity") 

house_tenure.tb <- as.factor(d$house_tenure)
house_tenure.tb <- summary(house_tenure.tb)
house_tenure.tb <- as.data.frame(house_tenure.tb)
house_tenure.tb$Var1 <- substring(row.names(house_tenure.tb), 1)
house_tenure.tb$group <- revalue(as.character(house_tenure.tb$Var1), c("1" = "An owner", "2" = "A tenant", "3" = "Resident in a relative or friend's home", "4" = "Resident other than in a relative or friend's home", "5" = "Other", "77" = "I don't know"))


## merge with existing prop table data used for plot above 
plot.house_tenure.tb <- merge(house_tenure, house_tenure.tb, by = "group")
plot.house_tenure.tb <- plot.house_tenure.tb[-c(2, 4, 6)]
plot.house_tenure.tb <- setcolorder(plot.house_tenure.tb, c("group", "house_tenure.tb", "Freq"))

plot.house_tenure.tb$order <- c(2,1,6,5,3,4)
plot.house_tenure.tb <- plot.house_tenure.tb %>% arrange(order)
plot.house_tenure.tb <- plot.house_tenure.tb[-c(4)]
colnames(plot.house_tenure.tb) <- c("Response", "N", "Percentage")

kable(plot.house_tenure.tb) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   

```

### In what type of dwelling do you currently live? Is it.
```{r}

#dwelling_type
dwelling_type <-round(prop.table(table(factor(d$dwelling_type)))*100,2)
dwelling_type <- as.data.frame(dwelling_type)
dwelling_type$answer <- substring(row.names(dwelling_type), 1)
dwelling_type$answer <- revalue(as.character(dwelling_type$answer), c("1" = "Single detached house", "2" = "Semi-detached house", "3" = "Row house",  "4" = "An apartment (or condo) in a duplex or triplex", "5" = "Apartment (or condo) in building with fewer than 5 storeys", "6" = "Apartment (or condo) in building with more than 5 storeys", "7" = "Mobile home/movable dwelling", "8" = "Senior's home", "9" = "Other", "10" = "Prefer not to say"))

dwelling_type$plot <- factor(dwelling_type$answer, dwelling_type$answer)

dwelling_type.plot <- ggplot(dwelling_type, aes(x = answer, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
  guides(fill = FALSE) +
  scale_fill_manual(values = INTERACTPaletteSet) +
  ylab("Percent of total") +
  xlab("")

dwelling_type.plot + geom_histogram(aes(x = plot), data = dwelling_type, stat = "identity") 

dwelling_type.tb <- as.factor(d$dwelling_type)
dwelling_type.tb <- summary(dwelling_type.tb)
dwelling_type.tb <- as.data.frame(dwelling_type.tb)
dwelling_type.tb$Var1 <- substring(row.names(dwelling_type.tb), 1)
dwelling_type.tb$answer <- revalue(as.character(dwelling_type.tb$Var1), c("1" = "Single detached house", "2" = "Semi-detached house", "3" = "Row house",  "4" = "An apartment (or condo) in a duplex or triplex", "5" = "Apartment (or condo) in building with fewer than 5 storeys", "6" = "Apartment (or condo) in building with more than 5 storeys", "7" = "Mobile home/movable dwelling", "8" = "Senior's home", "9" = "Other", "77" = "Prefer not to say"))

## merge with existing prop table data used for plot above 
plot.dwelling_type.tb <- merge(dwelling_type, dwelling_type.tb, by = "answer")

plot.dwelling_type.tb <- plot.dwelling_type.tb %>% arrange(Var1.x)
plot.dwelling_type.tb <- plot.dwelling_type.tb[-c(2, 4, 6)]
plot.dwelling_type.tb <- setcolorder(plot.dwelling_type.tb, c("answer", "dwelling_type.tb", "Freq"))
colnames(plot.dwelling_type.tb) <- c("Response", "N", "Percentage")


kable(plot.dwelling_type.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```


### When did you move to your current residence?

```{r}
#residence


residence <- as.integer(format(as.Date(d$residence),"%Y"))
time <- 2019 - residence

ggplot(d, aes(x = time)) + geom_histogram(na.rm=TRUE, binwidth = 1, fill="#76D24A") + xlab("Years since moving to current residence") 


summary(time)
```

        


### Do you live with a dog?

```{r}
#dog 

dog <- (prop.table(table(factor(d$dog)))*100)
dog <- as.data.frame(dog)
dog$group <- substring(row.names(dog), 1)
dog$group <- revalue(as.character(dog$group), c("1" = "Yes",  "2" = "No"))

dog$group <- factor(dog$group, dog$group)

dog.plot <- ggplot(dog, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10))

dog.plot + geom_histogram(aes(x = group), data = dog, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

## Table
dog.tb <- data.frame(Response = c("Yes", "No"),
           Frequence = as.numeric(table(d$dog)), 
           Percentage = round(as.numeric(prop.table(table(factor(d$dog)))*100),2))

kable(dog.tb) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```

### Do you walk the dog regularly?

```{r}
#dog_walk

d$dog_walk[d$dog_walk==-7] <- NA

dog_walk <- prop.table(table(factor(d$dog_walk)))*100
dog_walk <- as.data.frame(dog_walk)
dog_walk$group <- substring(row.names(dog_walk), 1)
dog_walk$group <- revalue(as.character(dog_walk$group), c("1" = "Yes",  "2" = "No"))

dog_walk$group <- factor(dog_walk$group, dog_walk$group)

dog_walk.plot <- ggplot(dog_walk, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) #order responses as in t5

dog_walk.plot + geom_histogram(aes(x = group), data = dog_walk, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values = INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

## Table
kable(data.frame(Response = c("Yes", "No"),
           Frequence = as.numeric(table(d$dog_walk)), Percentage = round(as.numeric(prop.table(table(d$dog_walk)))*100,2))) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   

```

### How many hours or minutes a day on average do you walk the dog?
```{r}

#dog_walk_freq
# max est 900, surement que quelqu'un a mis heures dans minutes? j'ai exclu cette r?ponse 

d$dog_walk_freq[d$dog_walk_freq==900] <- NA
d$dog_walk_freq[d$dog_walk_freq==-7] <- NA

ggplot(d, aes(x=d$dog_walk_freq)) + geom_histogram (na.rm = TRUE, fill="#1596FF", binwidth = 10) + xlab("Number of minutes per day")


## Table
summary(d$dog_walk_freq)
```

### What is your current gender identity?

```{r}
#gender 

gender <- round(prop.table(table(factor(d$gender, levels = c("1", "2", "3", "4", "5", "99"))))*100,2)
gender <- as.data.frame(gender)
gender$response <- substring(row.names(gender), 1)
gender$response <- revalue(as.factor(gender$response), c("1"="Man","2"="Woman","3"="Trans man", "4"="Trans woman", "5"="Genderqueer/Gender non-conforming", "6"="Different identity"))

gender$response <- factor(gender$response, gender$response)

 
p <- ggplot(gender, aes(x = response, y = Freq, fill = response)) + theme(axis.text.x = element_text(size=12, angle=90, vjust = .6, hjust= 1))

p + geom_histogram(aes(x = response), data = gender, stat = "identity") +
  scale_fill_manual(values = INTERACTPaletteSet) +
  guides(fill=FALSE) +
      ylab("Percent of total") +
      xlab("Gender") 


gender.tb <- as.factor(d$gender)
gender.tb <- summary(gender.tb)
gender.tb <- as.data.frame(gender.tb)
gender.tb$Var1 <- substring(row.names(gender.tb), 1)

nval.df <- c("0") #insert missing values 
nval.df <- as.data.frame(nval.df)
nval.df$gender.tb <- as.factor(nval.df$nval.df)
nval.df$Var1 <- c("4")
nval.df <- nval.df[-c(1)]

gender.tb <- rbind(gender.tb, nval.df)

gender.tb$response <- revalue(as.character(gender.tb$Var1), c("1"="Man","2"="Woman","3"="Trans man", "4"="Trans woman", "5"="Genderqueer/Gender non-conforming", "99"="Different identity"))
plot.gender <- merge(gender, gender.tb, by = "response")

plot.gender <- plot.gender %>% arrange(Var1.x)
plot.gender <- plot.gender[-c(2, 5)]
plot.gender <- setcolorder(plot.gender, c("response", "gender.tb", "Freq"))
colnames(plot.gender) <- c("Response", "N", "Percentage")


kable(plot.gender) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")



```


### What sex were you assigned at birth?


```{r}
# Sex

sex <- prop.table(table(factor(Health$sex, levels = 1:3)))*100
sex <- as.data.frame(sex)
sex$response <- substring(row.names(sex), 1)
sex$response <- revalue(as.factor(sex$response), c("1" = "Male", "2" = "Female", "3" = "Other"))

sex$response <- factor(sex$response, sex$response)

p <- ggplot(sex, aes(x = response, y = Freq, fill = response)) + theme(axis.text.x = element_text(angle=90, vjust = .6))

p + geom_histogram(aes(x = response), data = sex, stat = "identity") +
 scale_fill_manual(values = INTERACTPaletteSet) +
  guides(fill=FALSE) +
      ylab("Percent of total") +
      xlab("Sex") 

## Table- 
kable(data.frame(Response = c("Male","Female"),
           Frequence = as.numeric(table(d$sex)), 
           Percentage = round(as.numeric(prop.table(table(d$sex)))*100,2))) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   
```


### What is your marital status? Are you...

```{r}
#marital_status 

marital <- prop.table(table(factor(d$marital_status, levels = c("1", "2", "3", "4")), exclude = NULL))*100
marital <- as.data.frame(marital)
marital$group <- substring(row.names(marital), 1)
marital$group <- revalue(as.character(marital$group), c("1" = "Single", "2" = "Married/commonlaw", "3" = "Separated/divorced", "4" = "Widowed"))

marital$plot <- factor(marital$group, marital$group)

marital.plot <- ggplot(marital, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = INTERACTPaletteSet)  +
      ylab("Percent of total") +
      xlab("")
      
marital.plot + geom_histogram(aes(x = plot), data = marital, stat = "identity") 

## Table- 
kable(data.frame(Response = c("Single", "Married/commonlaw", "Separated/divorced", "Widowed"),
           Frequence = as.numeric(table(d$marital_status)), Percentage = round(as.numeric(prop.table(table(d$marital_status)))*100,2))) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   

```

### Do you have children?

```{r}
#children

children <- prop.table(table(factor(d$children, levels = c("1", "2")), exclude=NULL))*100
children <- as.data.frame(children)
children$group <- substring(row.names(children), 1)
children$group <- revalue(as.character(children$group), c("1" = "Yes",  "2" = "No"))

children$plot <- factor(children$group, children$group)

children.plot <- ggplot(children, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) #order responses as in t5

children.plot + geom_histogram(aes(x = plot), data = children, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values = INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

## Table- 
kable(data.frame(Response = c("Yes", "No"),
           Frequence = as.numeric(table(d$children)), Percentage = round(as.numeric(prop.table(table(d$children)))*100,2))) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   
```


### How many children do you have?

```{r}

#living_children
# look at summary table 

d$living_children[d$living_children==-7] <- NA

living_children <- round(prop.table(table(factor(d$living_children)))*100,2)
living_children <- as.data.frame(living_children)
living_children <- as.data.frame(living_children)
living_children$answer <- substring(row.names(living_children), 1)
living_children$answer <- revalue(as.character(living_children$answer))

living_children$plot <- factor(living_children$answer, living_children$answer)

living_children.plot <- ggplot(living_children, aes(x = answer, y = Freq, fill = plot, na.rm = TRUE)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) 

living_children.plot + geom_histogram(aes(x = plot), data = living_children, stat = "identity") +
guides(fill = FALSE) +
  scale_fill_manual(values = INTERACTPalette3)+
  ylab("Percent of total") +
  xlab("Response")

living_children.tb <- data.frame(Response = c("1", "2", "3", "4", "5"),
           Frequence = as.numeric(table(d$living_children)), Percentage = round(as.numeric(prop.table(table(d$living_children)))*100,2)) 


kable(living_children.tb) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")    

```

### What is your current living arrangement? Do you live {.tabset}

#### alone

```{r}

#d$living_arrange_1[d$living_arrange_1==-7] <- NA

living_arrange_1 <- round(prop.table(table(factor(d$living_arrange_1)))*100,2)
living_arrange_1 <- as.data.frame(living_arrange_1)
living_arrange_1$group <- substring(row.names(living_arrange_1), 1)
living_arrange_1$group <- revalue(as.character(living_arrange_1$group), c("1" = "With other people",  "2" = "Alone"))

#living_arrange_1$plot <- factor(living_arrange_1$group, living_arrange_1$group)

living_arrange_1.plot <- ggplot(living_arrange_1, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) #order responses as in t5

living_arrange_1.plot + geom_histogram(aes(x = group), data = living_arrange_1, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values = INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

## Table- 
kable(data.frame(Response = c("With other people", "Alone"),
           Frequence = as.numeric(table(d$living_arrange_1)), Percentage = round(as.numeric(prop.table(table(d$living_arrange_1)))*100,2))) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   


```

#### With other people 

_Participants could choose multiple answers_

```{r}
#living_arrange  

# Create a vector with variable names
response = paste0("living_arrange_", 2:7)

# Empty vector to stor output
living_arrange_prop <- c()

# Calculate univariate proportions
for(i in response){
  living_arrange_prop[i] <- sum(d[,i]) / nrow(d)
}

# Transform
living_arrange_prop <- as.data.frame(living_arrange_prop)
living_arrange_prop$Response <- c("With a spouse (or partner)","With children","With grandchildren","With relatives or siblings?", "With friends", "With other people")

living_arrange_prop$plot<- factor(living_arrange_prop$Response, living_arrange_prop$Response)

ggplot(living_arrange_prop, aes(x = plot, y = living_arrange_prop)) + geom_bar(stat = "identity", fill = "#76D24A") + xlab("") + ylab("Percentage of participants who selected this answer") + theme(axis.text.x  = element_text(size=12, angle=0, vjust=.6)) + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10))

living_arrange_prop$living_arrange_prop <- round(living_arrange_prop$living_arrange_prop*100,2)

living_arrange_prop <- setcolorder(living_arrange_prop, c("Response", "living_arrange_prop"))

colnames(living_arrange_prop) <- c("Response", "Percentage of participants who selected this answer")

living_arrange_prop <- living_arrange_prop[-c(3)]
kable(living_arrange_prop) %>% kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  




```


### How many children under the age of 16 live in your household?

```{r}
#children_household

ggplot(d, aes(x = d$children_household)) + geom_bar(na.rm = TRUE,fill="#76D24A", binwidth = 1) + xlab("Number of children under 16 in household")


summary(d$children_household)
```


### How many adults aged 16 or older live in your household including yourself?

```{r}

ggplot(d, aes(x = d$adults_household)) + geom_bar(na.rm = TRUE,fill="#76D24A", binwidth = 1) + xlab("Number of adults in household")

summary(d$children_household)

```


### Were you born in Canada?

```{r}
#born_can
born_can <- prop.table(table(factor(d$born_can, levels = c("1", "2")), exclude=NULL))*100
born_can <- as.data.frame(born_can)
born_can$group <- substring(row.names(born_can), 1)
born_can$group <- revalue(as.character(born_can$group), c("1" = "Yes",  "2" = "No"))

born_can$plot <- factor(born_can$group, born_can$group)

born_can.plot <- ggplot(born_can, aes(x = group, y = Freq, fill = plot)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) #order responses as in t5

born_can.plot + geom_histogram(aes(x = plot), data = born_can, stat = "identity") +
      guides(fill = FALSE) +
      scale_fill_manual(values = INTERACTPaletteYN) +
      ylab("Percent of total") +
      xlab("Response")

## Table- 

born_can.tb <- data.frame(Response = c("Yes", "No"),
                          Frequence = as.numeric(table(d$born_can)), 
                          Percentage = round(as.numeric(prop.table(table(d$born_can)))*100,2))


kable(born_can.tb) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")   

```


### When did you move to Canada?

```{r move_can}

#move_can 

d$move_can[d$move_can==-7] <- NA
ggplot(d, aes(x = d$move_can)) + geom_histogram (na.rm=TRUE, binwidth = 1, fill="#76D24A") + xlab("Year of move to Canada")

summary(d$move_can)
```

### To which ethnic or cultural group(s) do you belong? (Check all that apply)

```{r group_id_mtl}


identity <- round(prop.table(table(factor(eth$eth, levels = c("Indigenous or Aboriginal", 
                                                              "White",
                                                              "South Asian",
                                                              "Chinese",
                                                              "Black",
                                                              "Filipino",
                                                              "Latin American",
                                                              "Arab",
                                                              "Southeast Asian",
                                                              "West Asian",
                                                              "Korean", 
                                                              "Japanese", 
                                                              "Other/mixed identity",
                                                              "I don't know/Prefer not to answer"))))*100,2)
identity <- as.data.frame(identity)
identity$group <- substring(row.names(identity), 1)
identity$group <- factor(identity$group, identity$group)

getPalette = colorRampPalette(brewer.pal(9, "Paired"))

identity.plot <- ggplot(identity, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 10, angle=0.45, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=getPalette(14))  +
      ylab("Percent of total") +
      xlab("")
      
identity.plot + geom_histogram(aes(x = Var1), data = identity, stat = "identity") 

#table 
identity.tb <- as.factor(eth$eth)
identity.tb <- summary(identity.tb)
identity.tb <- as.data.frame(identity.tb)
identity.tb$Var1 <- substring(row.names(identity.tb), 1)

## merge with existing prop table data used for plot above 
plot.identity.tb <- merge(identity, identity.tb, by = "Var1")
plot.identity.tb <- plot.identity.tb %>% arrange(group)
plot.identity.tb <- plot.identity.tb[-c(3)]
plot.identity.tb <- setcolorder(plot.identity.tb, c("Var1", "identity.tb", "Freq"))

colnames(plot.identity.tb) <- c("Response", "N", "Percentage")

kable(plot.identity.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")


```


### Which category best describes your annual household income, taking into account all sources of income?

```{r}

income <- prop.table(table(factor(d$income, levels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "77")), exclude = NULL))*100
income <- as.data.frame(income)
income$group <- substring(row.names(income), 1)
income$group <- revalue(as.character(income$group), c("1" = "No income", "2" = "$1 to $9,999", "3" = "$10,000 to $14,999", "4" = "$15,000 to $19,999", "5" = "$20,000 to $29,999", "6" = "$30,000 to $39,999", "7" = "$40,000 to $49,999", "8" = "$50,000 to $99,999", "9" = "$100,000 to $149,999", "10" = " $150,000 to $199,999", "11" = "$200,000 or more", "12" = "Don't know/prefer no answer"))

income$group <- factor(income$group, income$group)

getPalette = colorRampPalette(brewer.pal(9, "BuGn"))

income.plot <- ggplot(income, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values = getPalette(12)) +
      ylab("Percent of total") +
      xlab("")

      
income.plot + geom_histogram(aes(x = group), data = income, stat = "identity")

## Table- 
income.tb <- data.frame(Response = c("No income", "$1 to $9,999", "$10,000 to $14,999", "$15,000 to $19,999", "$20,000 to $29,999", "$30,000 to $39,999",  "$40,000 to $49,999", "$50,000 to $99,999",  "$100,000 to $149,999",  " $150,000 to $199,999", "$200,000 or more",  "Don't know/prefer no answer"),
           Frequence = as.numeric(table(d$income)), Percentage = round(as.numeric(prop.table(table(d$income)))*100,2))

kable(income.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```


### To what extent does this annual household income allow you to satisfy your household's needs?

```{r income_needs}

#income_needs
income_needs <- round(prop.table(table(factor(d$income_needs, levels = c("1", "2", "3", "4", "77")), exclude = NULL))*100,2)
income_needs <- as.data.frame(income_needs)
income_needs$group <- substring(row.names(income_needs), 1)
income_needs$group <- revalue(as.character(income_needs$group), c("1" = "Very well", "2" = "Well", "3" = "Not so well", "4" = "Not at all", "5" = "Don't know/prefer no answer"))

income_needs$group <- factor(income_needs$group, income_needs$group)

income_needs.plot <- ggplot(income_needs, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPalette3) +
      ylab("Percent of total") +
      xlab("")
      
income_needs.plot + geom_histogram(aes(x = group), data = income_needs, stat = "identity") 


## Table- 
income_needs.tb <- data.frame(Response = c("Very well", "Well", "Not so well", "Not at all", "Don't know/prefer no answer"),
           Frequence = as.numeric(table(d$income_needs)), Percentage = round(as.numeric(prop.table(table(d$income_needs)))*100,2))

kable(income_needs.tb) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```

### What is your highest education level?

```{r education}

#education
education <- round(prop.table(table(factor(d$education, levels = c("1", "2", "3", "4","5", "77")), exclude = NULL))*100,2)
education <- as.data.frame(education)
education$group <- substring(row.names(education), 1)
education$group <- revalue(as.character(education$group), c("1" = "Primary/Elementary school", "2" = "Secondary school", "3" = "Trade/Technical school or college diploma", "4" = "University degree", "5" = "Graduate degree", "6" ="I don't know/Prefer not to answer"))

education$group <- factor(education$group, education$group)

education.plot <- ggplot(education, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteSet)  +
      ylab("Percent of total") +
      xlab("")
      
education.plot + geom_histogram(aes(x = group), data = education, stat = "identity") 


education.tb <- as.factor(d$education)
education.tb <- summary(education.tb)
education.tb <- as.data.frame(education.tb)
education.tb$Var1 <- substring(row.names(education.tb), 1)

nval.df <- c("0") #insert missing values 
nval.df <- as.data.frame(nval.df)
nval.df$education.tb <- as.factor(nval.df$nval.df)
nval.df$Var1 <- c("1")
nval.df <- nval.df[-c(1)]

education.tb <- rbind(education.tb, nval.df)

education.tb$group <- revalue(as.character(education.tb$Var1), c("1" = "Primary/Elementary school", "2" = "Secondary school", "3" = "Trade/Technical school or college diploma", "4" = "University degree", "5" = "Graduate degree", "77" ="I don't know/Prefer not to answer"))
plot.education <- merge(education, education.tb, by = "group")

plot.education <- plot.education %>% arrange(Var1.x)
plot.education <- plot.education[-c(2, 5)]
plot.education <- setcolorder(plot.education, c("group", "education.tb", "Freq"))
colnames(plot.education) <- c("Response", "N", "Percentage")


kable(plot.education) %>%   kable_styling(bootstrap_options = "striped", full_width = T, position = "left")

```


### What is your current employment status?

```{r}
#employment
employment <- prop.table(table(factor(d$employment, levels = c("1", "2", "3", "4","5", "6")), exclude = NULL))*100
employment <- as.data.frame(employment)
employment$group <- substring(row.names(employment), 1)
employment$group <- revalue(as.character(employment$group), c("1" = "Retired and not working", "2" = "Employed full-time", "3" = "Employed part-time", "4" = "Unemployed and looking for work", "5" = "Unemployed and not looking for work", "6" ="Other"))

employment$group <- factor(employment$group, employment$group)

employment.plot <- ggplot(employment, aes(x = group, y = Freq, fill = group)) + theme(axis.text.x  = element_text(size= 12, angle=0, vjust=.6))  + scale_x_discrete(labels = function(plot) str_wrap(plot, width = 10)) +
      guides(fill = FALSE) +
      scale_fill_manual(values=INTERACTPaletteSet)  +
      ylab("Percent of total") +
      xlab("")
      
employment.plot + geom_histogram(aes(x = group), data = employment, stat = "identity") 



employment.tb <- data.frame(Response = c(  "Retired and not working",  "Employed full-time",  "Employed part-time", "Unemployed and looking for work", "Unemployed and not looking for work", "Other"),
           Frequence = as.numeric(table(d$employment)), 
           Percentage = round(as.numeric(prop.table(table(d$employment)))*100,2))

kable(employment.tb) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left") 

```
### Age distribution
```{r age category plot}

# Create empty variable to store categorized age
d$age_cat <- NA

# Categorize age variable
d[d$age %in% c(18:24),"age_cat"] <- "18-24"
d[d$age %in% c(25:34),"age_cat"] <- "25-34"
d[d$age %in% c(35:44),"age_cat"] <- "35-44"
d[d$age %in% c(45:54),"age_cat"] <- "45-54"
d[d$age %in% c(55:64),"age_cat"] <- "55-64"
d[d$age %in% c(65:74),"age_cat"] <- "65-74"
d[d$age %in% c(75:100),"age_cat"] <-"75+"


# Plot age category bar chart
ggplot(data = d, aes(x = age_cat)) +
  geom_bar(fill = "#76D24A", aes(y = (..count..)/sum(..count..))) +
  labs(x = "Age", y = "Percent of total") +
  theme_bw()
```
```{r age category table}
#Create count table 
age <- data.frame(age_cat = names(table(d$age_cat)),
                    count = as.vector(table(d$age_cat)),
                    Percentage =as.vector(round(prop.table(table(d$age_cat))*100,2)))
# Print table
age 

```

### Language distribution 
```{r}

language <- data.frame(Language = names(table(d$questionnaire_lang)),
                    count = as.vector(table(d$questionnaire_lang)),
                    Percentage =as.vector(round(prop.table(table(d$questionnaire_lang))*100,2)))

kable(language) %>%  kable_styling(bootstrap_options = "striped", full_width = T, position = "left")  


```

